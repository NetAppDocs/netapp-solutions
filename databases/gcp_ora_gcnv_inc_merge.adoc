---
sidebar: sidebar
permalink: databases/gcp_ora_gcnv_inc_merge.html
keywords: Oracle, GCP, GCNV, Database, NFS, dNFS, VLDB, RMAN, Incremental Merge
summary: "The solution provides an overview and details for quick recovery of Oracle VLDB deployed to Google Compute Engine VM with NFS mount on Google Cloud NetApp Volumes storage pool to stage a standby database copy that is incrementally merged constantly via RMAN." 
---

= TR-5007: Optimize Oracle VLDB Backup & Recovery with In-Server Incremental Merge on Google Cloud NetApp Volumes
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ../media/

Allen Cao, Niyaz Mohamed, NetApp

[.lead]
The solution provides an overview and details for quick recovery of Oracle VLDB deployed to Google Compute Engine VM with NFS mount on Google Cloud NetApp Volumes storage pool to stage a standby database copy that is incrementally merged constantly via RMAN.

== Purpose

Recovering a Very Large Database (VLDB) in Oracle using the Oracle Recovery Manager (RMAN) backup tool can be a highly challenging task. The database restoration process from backup media in the event of a failure can be time-consuming, delaying the database recovery and potentially impacting your Service Level Agreement (SLA) significantly. The situation is getting even worse for Oracle VLDB deployed in the cloud as the RMAN backup is generally streamed to object storage due to cost considerations. As a result, it is not viable to restore and recover a VLDB if SLA is essential. Starting from version 10g, Oracle introduced an RMAN feature that allows users to create staged image copies of the Oracle database data files on additional disk storage located on the DB server host. These image copies can be incrementally updated using RMAN on a user-defined interval. In the case of a failure, the Database Administrator (DBA) can swiftly switch the Oracle database from the failed media to the image copy, eliminating the need for a complete database media restore. The result is a greatly improved SLA, albeit at the cost of doubling the required database storage. 

If you are keen on SLA for your VLDB and contemplating moving the Oracle database to a public cloud such as Google Cloud Platform (GCP), you could set up a similar database protection structure using resources such as Google Cloud NetApp Volumes (GCNV) for staging your standby database image copy. GCNV is a fully managed, high-performance file storage service offered by Google that makes it easier, safer, and more cost-efficient to migrate and run demanding enterprise applications such as Oracle database in Google Cloud. Its varied service levels allow the flexibility to control the storage cost while achieving close to zero RPO and a manageable RTO. In this documentation, we demonstrate how to provision and export an NFS file system from a GCNV storage pool to be mounted on an Oracle database server for staging a standby database copy for quick recovery in the event of a primary storage failure. 

This solution addresses the following use cases:

* An Oracle VLDB image copy incremental merge via RMAN on NFS mount point off Google Cloud NetApp Volumes storage pool.  
* Quick recovery of an Oracle VLDB in the event of a failure on the same or a standby Google Compute Engine VM.
* Options to clone a database copy for other use cases from staging DB image copy in minutes.
 

== Audience

This solution is intended for the following people:

* A DBA who sets up and manages Oracle VLDB in the Google Cloud Platform.
* A database solution architect who tests Oracle workloads in the Google Cloud Platform.
* A storage administrator who manages Oracle databases deployed to GCNV storage pools.
* An application owner who would like to stand up Oracle databases in Google Cloud Platform.

== Solution test and validation environment

The testing and validation of this solution was performed in Google Cloud NetApp Volumes storage pools and Google Compute Engine VMs that might not match the final deployment environment. For more information, see the section <<Key factors for deployment consideration>>.

=== Architecture

image:gcp_ora_gcnv_inc_merge_archit.png["This image provides a detailed picture of the Oracle VLDB incremental merge implementation in Google cloud with GCNV."]

=== Hardware and software components

[width=100%,cols="33%, 33%, 33%", frame=none, grid=rows]
|===
3+^| *Hardware*
| Google Cloud NetApp Volumes storage pools | Current services offered by Google | 2 TiB storage pool with Premium service, 2 TiB storage pool with standard service 
| Google Compute Engine VM for DB server | N1 (4 vcpus, 15 GiB memory) | 2 VMs, one as primary DB server and the other as a standby  

3+^| *Software*
| RedHat Linux | Red Hat Enterprise Linux 8.10 (Ootpa) - x86/64 | RHEL Marketplace image, PAYG
| Oracle Grid Infrastructure | Version 19.18 | Applied RU patch p34762026_190000_Linux-x86-64.zip
| Oracle Database | Version 19.18 | Applied RU patch p34765931_190000_Linux-x86-64.zip
| dNFS OneOff Patch | p32931941_190000_Linux-x86-64.zip | Applied to both grid and database
| Oracle OPatch | Version 12.2.0.1.36 | Latest patch p6880880_190000_Linux-x86-64.zip
| NFS | Version 3.0 | Oracle dNFS enabled
| Ansible | Version core 2.16.2 | python version - 3.10.13
|===

=== Key factors for deployment consideration

* *GCNV storage pool service level.* GCNV storage pool offers four service level: Standard, Premium, Extreme, and Flex. By default, an auto QoS applies to a volume created within a storage pool, which restricts the throughput on the volume based on its size as well as the service level. The only exception is that volumes allocated from Flex storage pool share the throughput available to the storage pool. 

* *Oracle VLDB in-server backup storage for RMAN incremental merge.* In our tests and validations, the NFS volume for Oracle incremental backup and merge is allocated from a single GCNV storage pool with standard service level, which has 100 TiB capacity limit. For deployment over the thresholds, multiple volumes, or GCNV storage pools implemented in parallel with multiple NFS mount points to provide higher capacity. 

* *Oracle recoverability using RMAN incremental merge.* The RMAN in-server incremental backup and merge is generally executed at user defined frequency based on your RTO and RPO objectives. If there are total loss of primary data storage and/or archived logs, the data loss can occur. The Oracle database can be recovered up to last incremental backup that is available from in-server database backup image copy. To minimize the data loss, Oracle flash recovery area can be setup on GCNV NFS backup mount point and archived logs are backed up to the same NFS mount along with database image copy to roll forward database to last archived log in the event of a failure. Thus, near zero RPO is achievable.  

* *Running Oracle VLDB off NFS image backup on GCNV storage pool.* At this point, switching DB volumes service level from standard to premium or extreme is not supported. However, change of service level from premium to extreme is supported. If there is expectation to run DB on database image backup on NFS mount point for a extended period of time, it is recommended to allocate volume from premium storage pool for database image backup until switching DB volumes from standard to premium or extreme comes available. 

* *Google Compute Engine VMs.* In these tests and validations, we used N1 type of GCE VM instance as the Oracle database servers. There are other types of GCE VMs that may be optimized and better suited for database workload. You also need to size the VM appropriately for the number of vCPUs and the amount of RAM based on actual workload requirements.
 
* *dNFS configuration.* dNFS is built into Oracle kernel and is known to dramatically increase Oracle database performance when Oracle is deployed to NFS storage. dNFS is packaged into Oracle binary but is not turned on by default. It should be turned on for any Oracle database deployment on NFS. For the multiple GCNV storage pools deployment for a VLDB, dNFS multi-paths to different GCNV storage pools should be properly configured.   


== Solution deployment

The solution assumes that an Oracle VLDB is already deployed in the Google Cloud environment within a VPC. The Oracle VLDB can run on either the GCNV storage or any other storage option within the Google Cloud ecosystem. The following section provides step-by-step deployment procedures for setting up RMAN incremental merge to an Oracle VLDB backup image copy on GCNV, which also has its primary storage hosted on GCNV.   

=== Prerequisites for deployment
[%collapsible%open]
====

Deployment requires the following prerequisites.

. A GCP account has been set up, and the necessary VPC and network configuration have been created within a project in the Google Cloud account.

. From the Google cloud portal console, follow documentation link:https://cloud.google.com/netapp/volumes/docs/configure-and-use/storage-pools/create-storage-pool[Create a storage pool^] to create a GCNV storage pool with standard service as shown below.
+
image:gcp_ora_gcnv_vldb_inc_merge_pool_01.png[This image showcases GCNV storage pool screen from Google cloud portal console]

. From the Google cloud portal console, follow documentation link:https://cloud.google.com/netapp/volumes/docs/configure-and-use/volumes/create-volume[Create a volume^] to create a volume for in-server Oracle VLDB image backup. In this solution demo, the VLDB primary storage is also hosted on GCNV as shown below.
+
image:gcp_ora_gcnv_vldb_inc_merge_vol_02.png[This image showcases GCNV storage volumes screen from Google cloud portal console]



====

=== Mount NFS volume from GCNV for in-server backup of the primary Oracle VLDB
[%collapsible%open]

====

The GCNV volume provisioned for VLDB in-server backup ideally should be situated in the same Google Cloud zone as the primary DB server and storage for better performance. 

. Retrieve the GCNV volume NFS export path from Google cloud console. 
+
image:gcp_ora_gcnv_vldb_inc_merge_vol_03.png[This image showcases GCNV storage volumes screen from Google cloud portal console]

. Login to primary Oracle VLDB server. As root, mount the NFS volume exported from GCNV storage. Change to your NFS server IP address and file path as needed. 
+
[source, cli]
sudo mkdir /nfsgcnv
+
[source, cli]
mount 10.165.128.5:/orap-bkup /nfsgcnv -o rw,bg,hard,vers=3,proto=tcp,timeo=600,rsize=262144,wsize=262144

. Change mount point ownership to oracle:oisntall, change to your oracle user name and primary group as necessary.
+
[source, cli]
sudo chown oracle:oinstall /nfsgcnv

. Add the NFS mount to /etc/fstab.
+
[source, cli]
sudo vi /etc/fstab


====

=== Setup Oracle RMAN incremental merge to image copy on GCNV for in-server VLDB backup
[%collapsible%open]

====

RMAN incremental merge updates the staging database data files image copy continuously at every incremental backup/merge interval. The image copy of database backup will be as up to date as the frequency you execute the incremental backup/merge. So, take into consideration of database performance, your RTO and RPO objectives when deciding the frequency of RMAN incremental backup and merge.

. Login to primary Oracle VLDB server as oracle user.

. Create an oracopy directory under mount point /nfsgcnv to store oracle data files image copies and an archlog directory for Oracle flash recovery area.
+
[source, cli]
mkdir /nfsgcnv/oracopy
+
[source, cli]
mkdir /nfsgcnv/archlog

. Login to Oracle database via sqlplus, enable block change tracking for faster incremental backup and change Oracle flash recovery area to GCNV NFS mount if it is currently on primary storage. This allows the RMAN default control file/spfile autobackup and archived logs to be backed up to GCNV NFS mount for database recovery to last available archive log.
+
[source, cli]
sqlplus / as sysdba
+
From sqlplus prompt, execute following command.
[source, cli]
alter database enable block change tracking using file '/nfsgcnv/oracopy/bct_ntap.ctf'
+
[source, cli]
alter system set db_recovery_file_dest='/nfsgcnv/archlog/' scope=both;
+
Expected output:
+
....
[oracle@ora-01 ~]$ sqlplus / as sysdba

SQL*Plus: Release 19.0.0.0.0 - Production on Wed Mar 20 16:44:21 2024
Version 19.18.0.0.0

Copyright (c) 1982, 2022, Oracle.  All rights reserved.

Connected to:
Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.18.0.0.0

SQL> alter database enable block change tracking using file '/nfsgcnv/oracopy/bct_ntap.ctf';

Database altered.

SQL> alter system set db_recovery_file_dest='/nfsgcnv/archlog/' scope=both;

System altered.

SQL> alter system set db_recovery_file_dest_size = 400G scope=both;

System altered.

SQL> show parameter recover

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
db_recovery_file_dest                string      /nfsgcnv/archlog/
db_recovery_file_dest_size           big integer 400G
db_unrecoverable_scn_tracking        boolean     TRUE
recovery_parallelism                 integer     0
remote_recovery_file_dest            string
SQL>

....

. Create a RMAN backup and incremental merge script. The script allocates multiple channels for parallel RMAN backup and merge. First execution would generate the initial full baseline image copy. In a complete run, it first purges obsolete backups that are outside of retention window to keep staging area clean. It then switches current log file before merge and backup. The incremental backup follows the merge so that the database image copy is trailing current database state by one backup/merge cycle. The merge and backup order can be reversed for quicker recovery at user's preference. The RMAN script can be integrated into a simple shell script to be executed from crontab on the primary DB server. Ensure control file autobackup is on in RMAN setting. 
+
....
vi /home/oracle/rman_bkup_merge.cmd

Add following lines:

RUN
{
  allocate channel c1 device type disk format '/nfsgcnv/oracopy/%U';
  allocate channel c2 device type disk format '/nfsgcnv/oracopy/%U';
  allocate channel c3 device type disk format '/nfsgcnv/oracopy/%U';
  allocate channel c4 device type disk format '/nfsgcnv/oracopy/%U';
  delete obsolete;
  sql 'alter system archive log current';
  recover copy of database with tag 'OraCopyBKUPonGCNV_level_0';
  backup incremental level 1 copies=1 for recover of copy with tag 'OraCopyBKUPonGCNV_level_0' database;
}


....

. At the primary Oracle VLDB server, login to RMAN locally as oracle user with or without RMAN catalog. In this demonstration, we are not connecting to a RMAN catalog. 
+
....

rman target / nocatalog;

output:

[oracle@ora-01 ~]$ rman target / nocatalog

Recovery Manager: Release 19.0.0.0.0 - Production on Wed Mar 20 16:54:24 2024
Version 19.18.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: NTAP1 (DBID=2441823937)
using target database control file instead of recovery catalog

....

. From RMAN prompt, execute the script. First execution creates a baseline database image copy and subsequent executions merge and update the baseline image copy incrementally. The following is how to execute the script and the typical output. Set the number of channels to match the CPU cores on the host. 
+
....

RMAN> @/home/oracle/rman_bkup_merge.cmd

RMAN> RUN
2> {
3>   allocate channel c1 device type disk format '/nfsgcnv/oracopy/%U';
4>   allocate channel c2 device type disk format '/nfsgcnv/oracopy/%U';
5>   allocate channel c3 device type disk format '/nfsgcnv/oracopy/%U';
6>   allocate channel c4 device type disk format '/nfsgcnv/oracopy/%U';
7>   delete obsolete;
8>   sql 'alter system archive log current';
9>   recover copy of database with tag 'OraCopyBKUPonGCNV_level_0';
10>   backup incremental level 1 copies=1 for recover of copy with tag 'OraCopyBKUPonGCNV_level_0' database;
11> }
allocated channel: c1
channel c1: SID=23 device type=DISK

allocated channel: c2
channel c2: SID=151 device type=DISK

allocated channel: c3
channel c3: SID=20 device type=DISK

allocated channel: c4
channel c4: SID=150 device type=DISK

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Deleting the following obsolete backups and copies:
Type                 Key    Completion Time    Filename/Handle
-------------------- ------ ------------------ --------------------
Backup Set           1      22-MAY-25
  Backup Piece       1      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201793914.260.1201793917
Backup Set           2      22-MAY-25
  Backup Piece       2      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201795422.261.1201795425
Backup Set           3      22-MAY-25
  Backup Piece       3      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201797230.262.1201797231
Backup Set           4      22-MAY-25
  Backup Piece       4      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201799039.264.1201799041
Backup Set           5      22-MAY-25
  Backup Piece       5      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201802655.265.1201802659
Backup Set           6      22-MAY-25
  Backup Piece       6      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201803558.266.1201803561
Backup Set           7      22-MAY-25
  Backup Piece       7      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201805066.267.1201805069
Backup Set           8      22-MAY-25
  Backup Piece       8      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201806272.268.1201806275
Backup Set           9      22-MAY-25
  Backup Piece       9      22-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201807778.269.1201807781
Backup Set           10     23-MAY-25
  Backup Piece       10     23-MAY-25          +LOGS/NTAP/AUTOBACKUP/2025_05_23/s_1201874668.271.1201874669
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201793914.260.1201793917 RECID=1 STAMP=1201793917
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201799039.264.1201799041 RECID=4 STAMP=1201799040
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201795422.261.1201795425 RECID=2 STAMP=1201795424
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201803558.266.1201803561 RECID=6 STAMP=1201803561
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201797230.262.1201797231 RECID=3 STAMP=1201797231
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201802655.265.1201802659 RECID=5 STAMP=1201802658
deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201805066.267.1201805069 RECID=7 STAMP=1201805069
Deleted 2 objects

deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201806272.268.1201806275 RECID=8 STAMP=1201806275
Deleted 3 objects

deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_22/s_1201807778.269.1201807781 RECID=9 STAMP=1201807780
Deleted 2 objects

deleted backup piece
backup piece handle=+LOGS/NTAP/AUTOBACKUP/2025_05_23/s_1201874668.271.1201874669 RECID=10 STAMP=1201874669
Deleted 3 objects


sql statement: alter system archive log current

Starting recover at 23-MAY-25
no copy of datafile 1 found to recover
no copy of datafile 3 found to recover
no copy of datafile 4 found to recover
no copy of datafile 5 found to recover
no copy of datafile 6 found to recover
no copy of datafile 7 found to recover
no copy of datafile 8 found to recover
no copy of datafile 9 found to recover
no copy of datafile 10 found to recover
no copy of datafile 11 found to recover
no copy of datafile 12 found to recover
no copy of datafile 13 found to recover
no copy of datafile 14 found to recover
no copy of datafile 15 found to recover
no copy of datafile 16 found to recover
no copy of datafile 17 found to recover
no copy of datafile 18 found to recover
no copy of datafile 19 found to recover
no copy of datafile 20 found to recover
no copy of datafile 21 found to recover
no copy of datafile 22 found to recover
no copy of datafile 23 found to recover
no copy of datafile 24 found to recover
no copy of datafile 25 found to recover
no copy of datafile 26 found to recover
no copy of datafile 27 found to recover
no copy of datafile 28 found to recover
no copy of datafile 29 found to recover
no copy of datafile 30 found to recover
no copy of datafile 31 found to recover
no copy of datafile 32 found to recover
no copy of datafile 33 found to recover
no copy of datafile 34 found to recover
no copy of datafile 35 found to recover
no copy of datafile 36 found to recover
no copy of datafile 37 found to recover
no copy of datafile 38 found to recover
no copy of datafile 39 found to recover
no copy of datafile 40 found to recover
no copy of datafile 41 found to recover
no copy of datafile 42 found to recover
no copy of datafile 43 found to recover
no copy of datafile 44 found to recover
no copy of datafile 45 found to recover
no copy of datafile 46 found to recover
no copy of datafile 47 found to recover
no copy of datafile 48 found to recover
no copy of datafile 49 found to recover
no copy of datafile 50 found to recover
Finished recover at 23-MAY-25

Starting backup at 23-MAY-25
no parent backup or copy of datafile 1 found
no parent backup or copy of datafile 3 found
no parent backup or copy of datafile 4 found
no parent backup or copy of datafile 7 found
no parent backup or copy of datafile 6 found
no parent backup or copy of datafile 5 found
no parent backup or copy of datafile 8 found
no parent backup or copy of datafile 21 found
no parent backup or copy of datafile 22 found
no parent backup or copy of datafile 25 found
no parent backup or copy of datafile 28 found
no parent backup or copy of datafile 32 found
no parent backup or copy of datafile 33 found
no parent backup or copy of datafile 36 found
no parent backup or copy of datafile 41 found
no parent backup or copy of datafile 44 found
no parent backup or copy of datafile 46 found
no parent backup or copy of datafile 10 found
no parent backup or copy of datafile 9 found
no parent backup or copy of datafile 11 found
no parent backup or copy of datafile 12 found
no parent backup or copy of datafile 23 found
no parent backup or copy of datafile 26 found
no parent backup or copy of datafile 29 found
no parent backup or copy of datafile 30 found
no parent backup or copy of datafile 34 found
no parent backup or copy of datafile 37 found
no parent backup or copy of datafile 39 found
no parent backup or copy of datafile 42 found
no parent backup or copy of datafile 47 found
no parent backup or copy of datafile 48 found
no parent backup or copy of datafile 14 found
no parent backup or copy of datafile 13 found
no parent backup or copy of datafile 15 found
no parent backup or copy of datafile 16 found
no parent backup or copy of datafile 24 found
no parent backup or copy of datafile 27 found
no parent backup or copy of datafile 31 found
no parent backup or copy of datafile 35 found
no parent backup or copy of datafile 38 found
no parent backup or copy of datafile 40 found
no parent backup or copy of datafile 43 found
no parent backup or copy of datafile 45 found
no parent backup or copy of datafile 49 found
no parent backup or copy of datafile 50 found
no parent backup or copy of datafile 18 found
no parent backup or copy of datafile 17 found
no parent backup or copy of datafile 19 found
no parent backup or copy of datafile 20 found
channel c1: starting datafile copy
input datafile file number=00021 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.286.1201793019
channel c2: starting datafile copy
input datafile file number=00022 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.287.1201793419
channel c3: starting datafile copy
input datafile file number=00025 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.290.1201794401
channel c4: starting datafile copy
input datafile file number=00028 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.293.1201795271
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-28_0f3q6gvn tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=4 STAMP=1201886858
channel c4: datafile copy complete, elapsed time: 01:19:26
channel c4: starting datafile copy
input datafile file number=00032 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.297.1201797351
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-25_0e3q6gvn tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=5 STAMP=1201886918
channel c3: datafile copy complete, elapsed time: 01:20:21
channel c3: starting datafile copy
input datafile file number=00033 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.298.1201800805
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-21_0c3q6gvm tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=6 STAMP=1201886943
channel c1: datafile copy complete, elapsed time: 01:20:50
channel c1: starting datafile copy
input datafile file number=00036 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.301.1201801969
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-22_0d3q6gvm tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=7 STAMP=1201887138
channel c2: datafile copy complete, elapsed time: 01:24:05
channel c2: starting datafile copy
input datafile file number=00041 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.306.1201803399
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-32_0g3q6lkl tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=8 STAMP=1201891753
channel c4: datafile copy complete, elapsed time: 01:21:26
channel c4: starting datafile copy
input datafile file number=00044 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.309.1201804651
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-36_0i3q6ln9 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=9 STAMP=1201891755
channel c1: datafile copy complete, elapsed time: 01:20:03
channel c1: starting datafile copy
input datafile file number=00046 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.312.1201806095
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-33_0h3q6lmf tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=10 STAMP=1201891766
channel c3: datafile copy complete, elapsed time: 01:20:44
channel c3: starting datafile copy
input datafile file number=00023 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.288.1201793535
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-41_0j3q6ltd tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=11 STAMP=1201892161
channel c2: datafile copy complete, elapsed time: 01:23:37
channel c2: starting datafile copy
input datafile file number=00026 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.291.1201795153
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-23_0m3q6qdr tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=12 STAMP=1201896617
channel c3: datafile copy complete, elapsed time: 01:20:53
channel c3: starting datafile copy
input datafile file number=00029 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.294.1201796261
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-46_0l3q6qdc tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=13 STAMP=1201896650
channel c1: datafile copy complete, elapsed time: 01:21:35
channel c1: starting datafile copy
input datafile file number=00030 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.295.1201797317
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-44_0k3q6qdc tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=14 STAMP=1201896694
channel c4: datafile copy complete, elapsed time: 01:22:20
channel c4: starting datafile copy
input datafile file number=00034 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.300.1201800829
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-26_0n3q6qq7 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=15 STAMP=1201897015
channel c2: datafile copy complete, elapsed time: 01:20:53
channel c2: starting datafile copy
input datafile file number=00037 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.302.1201802025
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-30_0p3q6v6b tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=16 STAMP=1201901480
channel c1: datafile copy complete, elapsed time: 01:20:37
channel c1: starting datafile copy
input datafile file number=00039 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.304.1201803375
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-29_0o3q6v5h tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=17 STAMP=1201901527
channel c3: datafile copy complete, elapsed time: 01:21:48
channel c3: starting datafile copy
input datafile file number=00042 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.307.1201804601
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-34_0q3q6v7o tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=18 STAMP=1201901805
channel c4: datafile copy complete, elapsed time: 01:25:14
channel c4: starting datafile copy
input datafile file number=00047 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.311.1201806051
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-37_0r3q6vhu tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=19 STAMP=1201901963
channel c2: datafile copy complete, elapsed time: 01:22:23
channel c2: starting datafile copy
input datafile file number=00048 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.313.1201873549
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-39_0s3q73th tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=20 STAMP=1201906343
channel c1: datafile copy complete, elapsed time: 01:20:55
channel c1: starting datafile copy
input datafile file number=00024 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.289.1201793665
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-42_0t3q73uv tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=21 STAMP=1201906415
channel c3: datafile copy complete, elapsed time: 01:21:24
channel c3: starting datafile copy
input datafile file number=00027 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.292.1201795207
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-47_0u3q747i tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=22 STAMP=1201906737
channel c4: datafile copy complete, elapsed time: 01:22:15
channel c4: starting datafile copy
input datafile file number=00031 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.296.1201797343
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-48_0v3q74cd tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=23 STAMP=1201906865
channel c2: datafile copy complete, elapsed time: 01:21:45
channel c2: starting datafile copy
input datafile file number=00035 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.299.1201800821
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-24_103q78l8 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=24 STAMP=1201911205
channel c1: datafile copy complete, elapsed time: 01:21:03
channel c1: starting datafile copy
input datafile file number=00038 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.303.1201802375
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-27_113q78nk tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=25 STAMP=1201911367
channel c3: datafile copy complete, elapsed time: 01:22:33
channel c3: starting datafile copy
input datafile file number=00040 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.305.1201803381
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-31_123q791p tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=26 STAMP=1201911632
channel c4: datafile copy complete, elapsed time: 01:21:33
channel c4: starting datafile copy
input datafile file number=00043 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.308.1201804629
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-35_133q795m tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=27 STAMP=1201911835
channel c2: datafile copy complete, elapsed time: 01:22:57
channel c2: starting datafile copy
input datafile file number=00045 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.310.1201806031
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-38_143q7dd7 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=28 STAMP=1201916184
channel c1: datafile copy complete, elapsed time: 01:23:06
channel c1: starting datafile copy
input datafile file number=00049 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.314.1201873563
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-40_153q7did tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=29 STAMP=1201916197
channel c3: datafile copy complete, elapsed time: 01:20:24
channel c3: starting datafile copy
input datafile file number=00050 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.315.1201875477
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-43_163q7dqp tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=30 STAMP=1201916471
channel c4: datafile copy complete, elapsed time: 01:20:40
channel c4: starting datafile copy
input datafile file number=00001 name=+DATA/NTAP/DATAFILE/system.257.1201727295
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-1_1a3q7ii2 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=31 STAMP=1201916673
channel c4: datafile copy complete, elapsed time: 00:03:15
channel c4: starting datafile copy
input datafile file number=00003 name=+DATA/NTAP/DATAFILE/sysaux.258.1201727339
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-45_173q7e17 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=32 STAMP=1201916703
channel c2: datafile copy complete, elapsed time: 01:21:05
channel c2: starting datafile copy
input datafile file number=00004 name=+DATA/NTAP/DATAFILE/undotbs1.259.1201727365
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-4_1c3q7ipa tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=33 STAMP=1201916821
channel c2: datafile copy complete, elapsed time: 00:01:55
channel c2: starting datafile copy
input datafile file number=00010 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/sysaux.273.1201729255
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-3_1b3q7io5 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=34 STAMP=1201916851
channel c4: datafile copy complete, elapsed time: 00:02:58
channel c4: starting datafile copy
input datafile file number=00014 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/sysaux.278.1201729279
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-10_1d3q7isu tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=35 STAMP=1201916936
channel c2: datafile copy complete, elapsed time: 00:01:52
channel c2: starting datafile copy
input datafile file number=00018 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/sysaux.283.1201729301
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-14_1e3q7itp tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=36 STAMP=1201916940
channel c4: datafile copy complete, elapsed time: 00:01:25
channel c4: starting datafile copy
input datafile file number=00006 name=+DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/sysaux.267.1201728307
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-6_1g3q7j0e tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=37 STAMP=1201917017
channel c4: datafile copy complete, elapsed time: 00:01:25
channel c4: starting datafile copy
input datafile file number=00009 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/system.272.1201729255
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-18_1f3q7j0e tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=38 STAMP=1201917035
channel c2: datafile copy complete, elapsed time: 00:01:34
channel c2: starting datafile copy
input datafile file number=00013 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/system.277.1201729279
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-9_1h3q7j35 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=39 STAMP=1201917090
channel c4: datafile copy complete, elapsed time: 00:01:03
channel c4: starting datafile copy
input datafile file number=00017 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/system.282.1201729301
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-13_1i3q7j3d tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=40 STAMP=1201917097
channel c2: datafile copy complete, elapsed time: 00:01:00
channel c2: starting datafile copy
input datafile file number=00005 name=+DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/system.266.1201728307
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-5_1k3q7j5a tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=42 STAMP=1201917174
channel c2: datafile copy complete, elapsed time: 00:01:25
channel c2: starting datafile copy
input datafile file number=00011 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/undotbs1.271.1201729255
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-17_1j3q7j56 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=41 STAMP=1201917174
channel c4: datafile copy complete, elapsed time: 00:01:31
channel c4: starting datafile copy
input datafile file number=00008 name=+DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/undotbs1.268.1201728307
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-11_1l3q7j80 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=44 STAMP=1201917237
channel c2: datafile copy complete, elapsed time: 00:00:56
channel c2: starting datafile copy
input datafile file number=00015 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/undotbs1.276.1201729279
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-8_1m3q7j82 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=43 STAMP=1201917232
channel c4: datafile copy complete, elapsed time: 00:00:55
channel c4: starting datafile copy
input datafile file number=00019 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/undotbs1.281.1201729301
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-15_1n3q7j9p tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=45 STAMP=1201917288
channel c2: datafile copy complete, elapsed time: 00:00:55
channel c2: starting datafile copy
input datafile file number=00007 name=+DATA/NTAP/DATAFILE/users.260.1201727365
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-19_1o3q7j9p tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=46 STAMP=1201917295
channel c4: datafile copy complete, elapsed time: 00:00:55
channel c4: starting datafile copy
input datafile file number=00012 name=+DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/users.275.1201729277
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-7_1p3q7jbg tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=47 STAMP=1201917297
channel c2: datafile copy complete, elapsed time: 00:00:02
channel c2: starting datafile copy
input datafile file number=00016 name=+DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/users.280.1201729301
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-12_1q3q7jbh tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=48 STAMP=1201917297
channel c4: datafile copy complete, elapsed time: 00:00:01
channel c4: starting datafile copy
input datafile file number=00020 name=+DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/users.285.1201729323
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-16_1r3q7jbi tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=49 STAMP=1201917298
channel c2: datafile copy complete, elapsed time: 00:00:01
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-20_1s3q7jbi tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=50 STAMP=1201917298
channel c4: datafile copy complete, elapsed time: 00:00:01
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-50_193q7i95 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=51 STAMP=1201919158
channel c3: datafile copy complete, elapsed time: 00:49:26
output file name=/nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-49_183q7i95 tag=ORACOPYBKUPONGCNV_LEVEL_0 RECID=52 STAMP=1201919167
channel c1: datafile copy complete, elapsed time: 00:49:36
Finished backup at 24-MAY-25

Starting Control File and SPFILE Autobackup at 24-MAY-25
piece handle=/nfsgcnv/archlog/NTAP/autobackup/2025_05_24/o1_mf_s_1201919173_n32cl775_.bkp comment=NONE
Finished Control File and SPFILE Autobackup at 24-MAY-25
released channel: c1
released channel: c2
released channel: c3
released channel: c4

RMAN> **end-of-file**

RMAN>


....

. List database image copy after backup to observe that a database image copy has been created in ANF NFS mount point.
+
....
RMAN> list copy of database tag 'OraCopyBKUPonGCNV_level_0';

List of Datafile Copies
=======================

Key     File S Completion Time Ckp SCN    Ckp Time        Sparse
------- ---- - --------------- ---------- --------------- ------
31      1    A 24-MAY-25       2812886    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-1_1a3q7ii2
        Tag: ORACOPYBKUPONGCNV_LEVEL_0

34      3    A 24-MAY-25       2813001    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-3_1b3q7io5
        Tag: ORACOPYBKUPONGCNV_LEVEL_0

33      4    A 24-MAY-25       2813043    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-4_1c3q7ipa
        Tag: ORACOPYBKUPONGCNV_LEVEL_0

42      5    A 24-MAY-25       2377077    21-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-5_1k3q7j5a
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

37      6    A 24-MAY-25       2377077    21-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-6_1g3q7j0e
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

47      7    A 24-MAY-25       2813504    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-7_1p3q7jbg
        Tag: ORACOPYBKUPONGCNV_LEVEL_0

43      8    A 24-MAY-25       2377077    21-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-8_1m3q7j82
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

39      9    A 24-MAY-25       2813238    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-9_1h3q7j35
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

35      10   A 24-MAY-25       2813112    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-10_1d3q7isu
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

44      11   A 24-MAY-25       2813425    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-11_1l3q7j80
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

48      12   A 24-MAY-25       2813508    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-12_1q3q7jbh
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

40      13   A 24-MAY-25       2813243    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-13_1i3q7j3d
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

36      14   A 24-MAY-25       2813124    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-14_1e3q7itp
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

45      15   A 24-MAY-25       2813463    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-15_1n3q7j9p
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

49      16   A 24-MAY-25       2813512    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-16_1r3q7jbi
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

41      17   A 24-MAY-25       2813364    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-17_1j3q7j56
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

38      18   A 24-MAY-25       2813185    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-18_1f3q7j0e
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

46      19   A 24-MAY-25       2813467    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-19_1o3q7j9p
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

50      20   A 24-MAY-25       2813516    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-USERS_FNO-20_1s3q7jbi
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

6       21   A 23-MAY-25       2768847    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-21_0c3q6gvm
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

7       22   A 23-MAY-25       2768851    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-22_0d3q6gvm
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

12      23   A 23-MAY-25       2777335    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-23_0m3q6qdr
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

24      24   A 24-MAY-25       2803186    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-24_103q78l8
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

5       25   A 23-MAY-25       2768856    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-25_0e3q6gvn
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

15      26   A 23-MAY-25       2777644    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-26_0n3q6qq7
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

25      27   A 24-MAY-25       2803231    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-27_113q78nk
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

4       28   A 23-MAY-25       2768859    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-28_0f3q6gvn
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

17      29   A 23-MAY-25       2781833    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-29_0o3q6v5h
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

16      30   A 23-MAY-25       2781842    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-30_0p3q6v6b
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

26      31   A 24-MAY-25       2803450    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-31_123q791p
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

8       32   A 23-MAY-25       2773143    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-32_0g3q6lkl
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

10      33   A 23-MAY-25       2773183    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-33_0h3q6lmf
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

18      34   A 23-MAY-25       2781890    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-34_0q3q6v7o
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

27      35   A 24-MAY-25       2803827    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-35_133q795m
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

9       36   A 23-MAY-25       2773193    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-36_0i3q6ln9
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

19      37   A 23-MAY-25       2782104    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-37_0r3q6vhu
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

28      38   A 24-MAY-25       2808047    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-38_143q7dd7
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

20      39   A 23-MAY-25       2786009    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-39_0s3q73th
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

29      40   A 24-MAY-25       2808169    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-40_153q7did
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

11      41   A 23-MAY-25       2773323    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-41_0j3q6ltd
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

21      42   A 23-MAY-25       2786042    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-42_0t3q73uv
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

30      43   A 24-MAY-25       2808367    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-43_163q7dqp
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

14      44   A 23-MAY-25       2777322    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-44_0k3q6qdc
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

32      45   A 24-MAY-25       2808624    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-45_173q7e17
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

13      46   A 23-MAY-25       2777326    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE1_FNO-46_0l3q6qdc
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 3, PDB Name: NTAP_PDB1

22      47   A 23-MAY-25       2786345    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-47_0u3q747i
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

23      48   A 23-MAY-25       2786456    23-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE2_FNO-48_0v3q74cd
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 4, PDB Name: NTAP_PDB2

52      49   A 24-MAY-25       2812634    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-49_183q7i95
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3

51      50   A 24-MAY-25       2812638    24-MAY-25       NO
        Name: /nfsgcnv/oracopy/data_D-NTAP_I-1379265854_TS-SOE3_FNO-50_193q7i95
        Tag: ORACOPYBKUPONGCNV_LEVEL_0
        Container ID: 5, PDB Name: NTAP_PDB3


RMAN>

....

. Report schema from Oracle RMAN command prompt to observe that current VLDB data files are on primary storage.
+
....

RMAN> report schema;

Report of database schema for database with db_unique_name NTAP

List of Permanent Datafiles
===========================
File Size(MB) Tablespace           RB segs Datafile Name
---- -------- -------------------- ------- ------------------------
1    1070     SYSTEM               YES     +DATA/NTAP/DATAFILE/system.257.1201727295
3    970      SYSAUX               NO      +DATA/NTAP/DATAFILE/sysaux.258.1201727339
4    680      UNDOTBS1             YES     +DATA/NTAP/DATAFILE/undotbs1.259.1201727365
5    400      PDB$SEED:SYSTEM      NO      +DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/system.266.1201728307
6    460      PDB$SEED:SYSAUX      NO      +DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/sysaux.267.1201728307
7    5        USERS                NO      +DATA/NTAP/DATAFILE/users.260.1201727365
8    235      PDB$SEED:UNDOTBS1    NO      +DATA/NTAP/86B637B62FE07A65E053F706E80A27CA/DATAFILE/undotbs1.268.1201728307
9    410      NTAP_PDB1:SYSTEM     YES     +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/system.272.1201729255
10   510      NTAP_PDB1:SYSAUX     NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/sysaux.273.1201729255
11   240      NTAP_PDB1:UNDOTBS1   YES     +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/undotbs1.271.1201729255
12   5        NTAP_PDB1:USERS      NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/users.275.1201729277
13   410      NTAP_PDB2:SYSTEM     YES     +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/system.277.1201729279
14   510      NTAP_PDB2:SYSAUX     NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/sysaux.278.1201729279
15   235      NTAP_PDB2:UNDOTBS1   YES     +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/undotbs1.276.1201729279
16   5        NTAP_PDB2:USERS      NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/users.280.1201729301
17   410      NTAP_PDB3:SYSTEM     YES     +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/system.282.1201729301
18   510      NTAP_PDB3:SYSAUX     NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/sysaux.283.1201729301
19   235      NTAP_PDB3:UNDOTBS1   YES     +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/undotbs1.281.1201729301
20   5        NTAP_PDB3:USERS      NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/users.285.1201729323
21   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.286.1201793019
22   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.287.1201793419
23   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.288.1201793535
24   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.289.1201793665
25   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.290.1201794401
26   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.291.1201795153
27   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.292.1201795207
28   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.293.1201795271
29   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.294.1201796261
30   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.295.1201797317
31   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.296.1201797343
32   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.297.1201797351
33   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.298.1201800805
34   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.300.1201800829
35   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.299.1201800821
36   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.301.1201801969
37   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.302.1201802025
38   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.303.1201802375
39   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.304.1201803375
40   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.305.1201803381
41   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.306.1201803399
42   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.307.1201804601
43   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.308.1201804629
44   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.309.1201804651
45   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.310.1201806031
46   30720    NTAP_PDB1:SOE1       NO      +DATA/NTAP/35AD38314E81AF11E063060B460AE362/DATAFILE/soe1.312.1201806095
47   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.311.1201806051
48   30720    NTAP_PDB2:SOE2       NO      +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/DATAFILE/soe2.313.1201873549
49   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.314.1201873563
50   30720    NTAP_PDB3:SOE3       NO      +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/DATAFILE/soe3.315.1201875477

List of Temporary Files
=======================
File Size(MB) Tablespace           Maxsize(MB) Tempfile Name
---- -------- -------------------- ----------- --------------------
1    123      TEMP                 32767       +DATA/NTAP/TEMPFILE/temp.265.1201727469
2    123      PDB$SEED:TEMP        32767       +DATA/NTAP/35AD01790801A78FE063060B460ABC41/TEMPFILE/temp.269.1201728335
3    16384    NTAP_PDB1:TEMP       32767       +DATA/NTAP/35AD38314E81AF11E063060B460AE362/TEMPFILE/temp.274.1201729271
4    30720    NTAP_PDB2:TEMP       32767       +DATA/NTAP/35AD39A949B7AF76E063060B460A61D2/TEMPFILE/temp.279.1201729295
5    30720    NTAP_PDB3:TEMP       32767       +DATA/NTAP/35AD3B0BAD41AFCEE063060B460AD1CC/TEMPFILE/temp.284.1201729319

RMAN>



....

. Validate database image copy from OS NFS mount point.
+
....
[oracle@orap ~]$ ls -l /nfsgcnv/oracopy/
total 954924748
-rw-r----- 1 oracle asm    11600384 May 27 16:25 bct_ntap.ctf
-rw-r----- 1 oracle asm 32212262912 May 23 17:29 data_D-NTAP_I-1379265854_TS-SOE1_FNO-21_0c3q6gvm
-rw-r----- 1 oracle asm 32212262912 May 23 17:32 data_D-NTAP_I-1379265854_TS-SOE1_FNO-22_0d3q6gvm
-rw-r----- 1 oracle asm 32212262912 May 23 17:28 data_D-NTAP_I-1379265854_TS-SOE1_FNO-25_0e3q6gvn
-rw-r----- 1 oracle asm 32212262912 May 23 17:27 data_D-NTAP_I-1379265854_TS-SOE1_FNO-28_0f3q6gvn
-rw-r----- 1 oracle asm 32212262912 May 23 18:49 data_D-NTAP_I-1379265854_TS-SOE1_FNO-32_0g3q6lkl
-rw-r----- 1 oracle asm 32212262912 May 23 18:49 data_D-NTAP_I-1379265854_TS-SOE1_FNO-33_0h3q6lmf
-rw-r----- 1 oracle asm 32212262912 May 23 18:49 data_D-NTAP_I-1379265854_TS-SOE1_FNO-36_0i3q6ln9
-rw-r----- 1 oracle asm 32212262912 May 23 18:56 data_D-NTAP_I-1379265854_TS-SOE1_FNO-41_0j3q6ltd
-rw-r----- 1 oracle asm 32212262912 May 23 20:11 data_D-NTAP_I-1379265854_TS-SOE1_FNO-44_0k3q6qdc
-rw-r----- 1 oracle asm 32212262912 May 23 20:10 data_D-NTAP_I-1379265854_TS-SOE1_FNO-46_0l3q6qdc
-rw-r----- 1 oracle asm 32212262912 May 23 20:10 data_D-NTAP_I-1379265854_TS-SOE2_FNO-23_0m3q6qdr
-rw-r----- 1 oracle asm 32212262912 May 23 20:16 data_D-NTAP_I-1379265854_TS-SOE2_FNO-26_0n3q6qq7
-rw-r----- 1 oracle asm 32212262912 May 23 21:32 data_D-NTAP_I-1379265854_TS-SOE2_FNO-29_0o3q6v5h
-rw-r----- 1 oracle asm 32212262912 May 23 21:31 data_D-NTAP_I-1379265854_TS-SOE2_FNO-30_0p3q6v6b
-rw-r----- 1 oracle asm 32212262912 May 23 21:36 data_D-NTAP_I-1379265854_TS-SOE2_FNO-34_0q3q6v7o
-rw-r----- 1 oracle asm 32212262912 May 23 21:39 data_D-NTAP_I-1379265854_TS-SOE2_FNO-37_0r3q6vhu
-rw-r----- 1 oracle asm 32212262912 May 23 22:52 data_D-NTAP_I-1379265854_TS-SOE2_FNO-39_0s3q73th
-rw-r----- 1 oracle asm 32212262912 May 23 22:53 data_D-NTAP_I-1379265854_TS-SOE2_FNO-42_0t3q73uv
-rw-r----- 1 oracle asm 32212262912 May 23 22:58 data_D-NTAP_I-1379265854_TS-SOE2_FNO-47_0u3q747i
-rw-r----- 1 oracle asm 32212262912 May 23 23:01 data_D-NTAP_I-1379265854_TS-SOE2_FNO-48_0v3q74cd
-rw-r----- 1 oracle asm 32212262912 May 24 00:13 data_D-NTAP_I-1379265854_TS-SOE3_FNO-24_103q78l8
-rw-r----- 1 oracle asm 32212262912 May 24 00:16 data_D-NTAP_I-1379265854_TS-SOE3_FNO-27_113q78nk
-rw-r----- 1 oracle asm 32212262912 May 24 00:20 data_D-NTAP_I-1379265854_TS-SOE3_FNO-31_123q791p
-rw-r----- 1 oracle asm 32212262912 May 24 00:23 data_D-NTAP_I-1379265854_TS-SOE3_FNO-35_133q795m
-rw-r----- 1 oracle asm 32212262912 May 24 01:36 data_D-NTAP_I-1379265854_TS-SOE3_FNO-38_143q7dd7
-rw-r----- 1 oracle asm 32212262912 May 24 01:36 data_D-NTAP_I-1379265854_TS-SOE3_FNO-40_153q7did
-rw-r----- 1 oracle asm 32212262912 May 24 01:41 data_D-NTAP_I-1379265854_TS-SOE3_FNO-43_163q7dqp
-rw-r----- 1 oracle asm 32212262912 May 24 01:45 data_D-NTAP_I-1379265854_TS-SOE3_FNO-45_173q7e17
-rw-r----- 1 oracle asm 32212262912 May 24 02:26 data_D-NTAP_I-1379265854_TS-SOE3_FNO-49_183q7i95
-rw-r----- 1 oracle asm 32212262912 May 24 02:25 data_D-NTAP_I-1379265854_TS-SOE3_FNO-50_193q7i95
-rw-r----- 1 oracle asm   534781952 May 24 01:48 data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-10_1d3q7isu
-rw-r----- 1 oracle asm   534781952 May 24 01:49 data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-14_1e3q7itp
-rw-r----- 1 oracle asm   534781952 May 24 01:50 data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-18_1f3q7j0e
-rw-r----- 1 oracle asm   985669632 May 24 01:47 data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-3_1b3q7io5
-rw-r----- 1 oracle asm   482353152 May 24 01:50 data_D-NTAP_I-1379265854_TS-SYSAUX_FNO-6_1g3q7j0e
-rw-r----- 1 oracle asm  1121984512 May 24 01:44 data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-1_1a3q7ii2
-rw-r----- 1 oracle asm   429924352 May 24 01:51 data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-13_1i3q7j3d
-rw-r----- 1 oracle asm   429924352 May 24 01:52 data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-17_1j3q7j56
-rw-r----- 1 oracle asm   419438592 May 24 01:52 data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-5_1k3q7j5a
-rw-r----- 1 oracle asm   429924352 May 24 01:51 data_D-NTAP_I-1379265854_TS-SYSTEM_FNO-9_1h3q7j35
-rw-r----- 1 oracle asm   251666432 May 24 01:53 data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-11_1l3q7j80
-rw-r----- 1 oracle asm   246423552 May 24 01:54 data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-15_1n3q7j9p
-rw-r----- 1 oracle asm   246423552 May 24 01:54 data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-19_1o3q7j9p
-rw-r----- 1 oracle asm   713039872 May 24 01:47 data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-4_1c3q7ipa
-rw-r----- 1 oracle asm   246423552 May 24 01:53 data_D-NTAP_I-1379265854_TS-UNDOTBS1_FNO-8_1m3q7j82
-rw-r----- 1 oracle asm     5251072 May 24 01:54 data_D-NTAP_I-1379265854_TS-USERS_FNO-12_1q3q7jbh
-rw-r----- 1 oracle asm     5251072 May 24 01:54 data_D-NTAP_I-1379265854_TS-USERS_FNO-16_1r3q7jbi
-rw-r----- 1 oracle asm     5251072 May 24 01:54 data_D-NTAP_I-1379265854_TS-USERS_FNO-20_1s3q7jbi
-rw-r----- 1 oracle asm     5251072 May 24 01:54 data_D-NTAP_I-1379265854_TS-USERS_FNO-7_1p3q7jbg

....

This completes the setup of an Oracle VLDB standby image copy backup and merge.

====

=== Switch Oracle VLDB to image copy for quick recovery
[%collapsible%open]
 
====
In the event of a failure due to primary storage issue such as data loss or corruption,  database can be quickly switched over to image copy on ANF NFS mount and recovered to current state without database restore. Eliminating media restoration speeds up the database recovery tremendously for a VLDB. This use case assumes that the Oracle VLDB DB server is intact and database control file, archived and current logs are all available for recovery.

. Login to Azure primary VLDB server host as oracle user and create a test table before switch over.
+
....
[oracle@ora-01 ~]$ sqlplus / as sysdba

SQL*Plus: Release 19.0.0.0.0 - Production on Thu Mar 21 15:13:52 2024
Version 19.18.0.0.0

Copyright (c) 1982, 2022, Oracle.  All rights reserved.


Connected to:
Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.18.0.0.0

SQL> show pdbs

    CON_ID CON_NAME                       OPEN MODE  RESTRICTED
---------- ------------------------------ ---------- ----------
         2 PDB$SEED                       READ ONLY  NO
         3 NTAP1_PDB1                     READ WRITE NO
         4 NTAP1_PDB2                     READ WRITE NO
         5 NTAP1_PDB3                     READ WRITE NO
SQL> alter session set container=ntap1_pdb1;

Session altered.

SQL> create table test (id integer, dt timestamp, event varchar(100));

Table created.

SQL> insert into test values(1, sysdate, 'test oracle incremental merge switch to copy');

1 row created.

SQL> commit;

Commit complete.

SQL> select * from test;

        ID
----------
DT
---------------------------------------------------------------------------
EVENT
--------------------------------------------------------------------------------
         1
21-MAR-24 03.15.03.000000 PM
test oracle incremental merge switch to copy



....

. Simulate a failure by shutdown abort database, then start up oracle in mount stage.
+
....

SQL> shutdown abort;
ORACLE instance shut down.
SQL> startup mount;
ORACLE instance started.

Total System Global Area 6442449688 bytes
Fixed Size                  9177880 bytes
Variable Size            1325400064 bytes
Database Buffers         5100273664 bytes
Redo Buffers                7598080 bytes
Database mounted.
SQL> exit

....

. As oracle user, connect to Oracle database via RMAN to switch database to copy.
+
....

[oracle@ora-01 ~]$ rman target / nocatalog

Recovery Manager: Release 19.0.0.0.0 - Production on Thu Mar 21 15:20:58 2024
Version 19.18.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: NTAP1 (DBID=2441823937, not open)
using target database control file instead of recovery catalog

RMAN> switch database to copy;

datafile 1 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_0r2m6nhk"
datafile 3 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_0s2m6nl1"
datafile 4 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_0t2m6nml"
datafile 5 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_162m6nuc"
datafile 6 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_122m6nti"
datafile 7 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_1a2m6o01"
datafile 8 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_172m6nvr"
datafile 9 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_132m6ntm"
datafile 10 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_0v2m6nqs"
datafile 11 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_0u2m6nqs"
datafile 12 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_1b2m6o0e"
datafile 13 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_142m6ntp"
datafile 14 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_102m6nr3"
datafile 15 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_182m6nvs"
datafile 16 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_1c2m6o0k"
datafile 17 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_152m6nts"
datafile 18 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_112m6nrt"
datafile 19 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_192m6nvv"
datafile 20 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_1d2m6o0k"
datafile 21 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_0f2m6brl"
datafile 22 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_0g2m6brl"
datafile 23 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_0h2m6brl"
datafile 24 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_0i2m6brl"
datafile 25 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_0j2m6fol"
datafile 26 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_0k2m6fot"
datafile 27 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_0l2m6frc"
datafile 28 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_0m2m6fsu"
datafile 29 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_0n2m6jlr"
datafile 30 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_0o2m6jlr"
datafile 31 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_0p2m6jrb"
datafile 32 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_0q2m6jsi"

....

. Recover and open database to bring it up to current from last incremental backup.
+
....
RMAN> recover database;

Starting recover at 21-MAR-24
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=392 device type=DISK
channel ORA_DISK_1: starting incremental datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
destination for restore of datafile 00009: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_0q1sd7cm
destination for restore of datafile 00023: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_041sd6s5
destination for restore of datafile 00027: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_081sd70i
destination for restore of datafile 00031: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_0c1sd74u
destination for restore of datafile 00034: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-34_0f1sd788
channel ORA_DISK_1: reading from backup piece /nfsanf/oracopy/321sfous_98_1_1
channel ORA_DISK_1: piece handle=/nfsanf/oracopy/321sfous_98_1_1 tag=ORACOPYBKUPONANF_LEVEL_0
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:01
channel ORA_DISK_1: starting incremental datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
destination for restore of datafile 00010: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_0k1sd7bb
destination for restore of datafile 00021: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_021sd6pv
destination for restore of datafile 00025: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_061sd6uc
.
.
.
channel ORA_DISK_1: starting incremental datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
destination for restore of datafile 00016: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_121sd7dn
channel ORA_DISK_1: reading from backup piece /nfsanf/oracopy/3i1sfov0_114_1_1
channel ORA_DISK_1: piece handle=/nfsanf/oracopy/3i1sfov0_114_1_1 tag=ORACOPYBKUPONANF_LEVEL_0
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:01
channel ORA_DISK_1: starting incremental datafile backup set restore
channel ORA_DISK_1: specifying datafile(s) to restore from backup set
destination for restore of datafile 00020: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_131sd7do
channel ORA_DISK_1: reading from backup piece /nfsanf/oracopy/3j1sfov0_115_1_1
channel ORA_DISK_1: piece handle=/nfsanf/oracopy/3j1sfov0_115_1_1 tag=ORACOPYBKUPONANF_LEVEL_0
channel ORA_DISK_1: restored backup piece 1
channel ORA_DISK_1: restore complete, elapsed time: 00:00:01

starting media recovery
media recovery complete, elapsed time: 00:00:01

Finished recover at 21-MAR-24

RMAN> alter database open;

Statement processed

RMAN>

....

. Check database structure from sqlplus after recovery to observe that all VLDB data files with exception of control, temp, and current log files are now switched over to copy on ANF NFS file system.
+
....

SQL> select name from v$datafile
  2  union
  3  select name from v$tempfile
  4  union
  5  select name from v$controlfile
  6  union
  7* select member from v$logfile
SQL> /

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_0f2m6brl
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_0g2m6brl
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_0h2m6brl
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_0i2m6brl
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_0j2m6fol
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_0k2m6fot
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_0l2m6frc
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_0m2m6fsu
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_0n2m6jlr
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_0o2m6jlr
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_0p2m6jrb

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_0q2m6jsi
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_0v2m6nqs
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_102m6nr3
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_112m6nrt
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_0s2m6nl1
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_122m6nti
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_142m6ntp
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_152m6nts
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_0r2m6nhk
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_162m6nuc
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_132m6ntm

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_0u2m6nqs
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_182m6nvs
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_192m6nvv
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_0t2m6nml
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_172m6nvr
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_1b2m6o0e
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_1c2m6o0k
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_1d2m6o0k
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_1a2m6o01
/u02/oradata/NTAP1/NTAP1_pdb1/temp01.dbf
/u02/oradata/NTAP1/NTAP1_pdb1/temp02.dbf

NAME
--------------------------------------------------------------------------------
/u02/oradata/NTAP1/NTAP1_pdb2/temp01.dbf
/u02/oradata/NTAP1/NTAP1_pdb3/temp01.dbf
/u02/oradata/NTAP1/control01.ctl
/u02/oradata/NTAP1/pdbseed/temp012024-03-18_16-07-32-463-PM.dbf
/u02/oradata/NTAP1/temp01.dbf
/u03/orareco/NTAP1/control02.ctl
/u03/orareco/NTAP1/onlinelog/redo01.log
/u03/orareco/NTAP1/onlinelog/redo02.log
/u03/orareco/NTAP1/onlinelog/redo03.log

42 rows selected.

....

. From SQL plus, check the content of test table we have inserted before the switch over to copy.
+
....

SQL> alter session set container=ntap1_pdb1;

Session altered.

SQL> select * from test;

        ID
----------
DT
---------------------------------------------------------------------------
EVENT
--------------------------------------------------------------------------------
         1
21-MAR-24 03.15.03.000000 PM
test oracle incremental merge switch to copy


SQL>


....

. You could run the Oracle VLDB in ANF NFS mount for an extended period of time while maintaining expected performance level. When the primary storage issue is fixed, you can swing back to it by reversing the incremental backup merge processes with minimal downtime.  


====

=== Oracle VLDB recovery from image copy to a standby DB server
[%collapsible%open]

====

In the event of a failure where both the primary storage and primary DB server host are lost, recovery cannot be performed from the original server. However, your Oracle database backup image copy available on the ANF NFS file system comes in handy. You can quickly recover the primary database to a standby DB server if one is available, using the backup image copy. In this section, we will demonstrate the step-by-step procedures for such recovery. 

. Insert a row to test table we have created previously for Oracle VLDB restoring to alternative host validation.
+
....

SQL> insert into test values(2, sysdate, 'test recovery on a new Azure VM host with image copy on ANF');

1 row created.

SQL> commit;

Commit complete.

SQL> select * from test;

        ID
----------
DT
---------------------------------------------------------------------------
EVENT
--------------------------------------------------------------------------------
         1
21-MAR-24 03.15.03.000000 PM
test oracle incremental merge switch to copy

         2
22-MAR-24 02.22.06.000000 PM
test recovery on a new Azure VM host with image copy on ANF

        ID
----------
DT
---------------------------------------------------------------------------
EVENT
--------------------------------------------------------------------------------


SQL>

....

. As oracle user, run RMAN incremental backup and merge to flush the transaction to backup set on ANF NFS mount.
+
....
[oracle@ip-172-30-15-99 ~]$ rman target / nocatalog

Recovery Manager: Release 19.0.0.0.0 - Production on Tue May 30 17:26:03 2023
Version 19.18.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: NTAP1 (DBID=2441823937)
using target database control file instead of recovery catalog

RMAN> @rman_bkup_merge.cmd

....

. Shutdown primary VLDB server host to simulate a total failure of storage and DB server host.

. On the standby DB server ora-02 with same OS and version, OS kernal should be patched up as primary VLDB server host. Also, the same version and patches of Oracle has been installed and configured on standby DB server with software only option. 

. Configure oracle environment similiarly to primary VLDB server ora_01, such as oratab, and oracle user .bash_profile etc. It is a good practice to backup those files to ANF NFS mount point.

. The Oracle database backup image copy on ANF NFS file system is then mounted on the standby DB server for recovery. The following procedures demonstrate the process details.
+
As azueruser, create the mount point.
+
[source, cli]
sudo mkdir /nfsanf
+
As azureuser, mount the NFS volume that stored Oracle VLDB backup image copy.
[source, cli]
sudo mount 172.30.136.68:/ora-01-u02-copy /nfsanf -o rw,bg,hard,vers=3,proto=tcp,timeo=600,rsize=262144,wsize=262144,nointr

. Validate the Oracle database backup image copy on ANF NFS mount point.
+
....

[oracle@ora-02 ~]$ ls -ltr /nfsanf/oracopy/
total 400452728
-rw-r-----. 1 oracle oinstall   461381632 Mar 21 23:47 data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_242m9oan
-rw-r-----. 1 oracle oinstall   419438592 Mar 21 23:49 data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_282m9oem
-rw-r-----. 1 oracle oinstall   246423552 Mar 21 23:49 data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_292m9oem
-rw-r-----. 1 oracle oinstall    21438464 Mar 22 14:35 2h2mbccv_81_1_1
-rw-r-----. 1 oracle oinstall    17956864 Mar 22 14:35 2i2mbcd0_82_1_1
-rw-r-----. 1 oracle oinstall    17956864 Mar 22 14:35 2j2mbcd1_83_1_1
-rw-r-----. 1 oracle oinstall    15245312 Mar 22 14:35 2k2mbcd3_84_1_1
-rw-r-----. 1 oracle oinstall     1638400 Mar 22 14:35 2m2mbcdn_86_1_1
-rw-r-----. 1 oracle oinstall    40042496 Mar 22 14:35 2l2mbcdn_85_1_1
-rw-r-----. 1 oracle oinstall    21856256 Mar 22 14:35 2n2mbcdo_87_1_1
-rw-r-----. 1 oracle oinstall     3710976 Mar 22 14:35 2o2mbcdv_88_1_1
-rw-r-----. 1 oracle oinstall     3416064 Mar 22 14:35 2p2mbcdv_89_1_1
-rw-r-----. 1 oracle oinstall     2596864 Mar 22 14:35 2r2mbce0_91_1_1
-rw-r-----. 1 oracle oinstall     2531328 Mar 22 14:35 2s2mbce1_92_1_1
-rw-r-----. 1 oracle oinstall     4718592 Mar 22 14:35 2v2mbce2_95_1_1
-rw-r-----. 1 oracle oinstall     4243456 Mar 22 14:35 302mbce2_96_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 14:35 312mbce3_97_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 14:35 322mbce3_98_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 14:35 332mbce3_99_1_1
-rw-r-----. 1 oracle oinstall   608182272 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_202m9o22
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_1q2m9k7a
-rw-r-----. 1 oracle oinstall   555753472 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_212m9o52
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_1m2m9g9j
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_1n2m9gcg
-rw-r-----. 1 oracle oinstall   429924352 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_252m9oc5
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_1i2m9cap
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_1j2m9cap
-rw-r-----. 1 oracle oinstall     5251072 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_2d2m9ofs
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_1o2m9gd4
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_1r2m9kfk
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_1p2m9ju6
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_1s2m9kgg
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_1l2m9g3u
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_1k2m9cap
-rw-r-----. 1 oracle oinstall 33286004736 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_1h2m9cap
-rw-r-----. 1 oracle oinstall  1121984512 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_1t2m9nij
-rw-r-----. 1 oracle oinstall  1142956032 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_1u2m9nog
-rw-r-----. 1 oracle oinstall   728768512 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_1v2m9nu6
-rw-r-----. 1 oracle oinstall   534781952 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_222m9o53
-rw-r-----. 1 oracle oinstall   534781952 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_232m9oa8
-rw-r-----. 1 oracle oinstall   429924352 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_262m9oca
-rw-r-----. 1 oracle oinstall   246423552 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_2a2m9of6
-rw-r-----. 1 oracle oinstall   429924352 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_272m9oel
-rw-r-----. 1 oracle oinstall     5251072 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_2c2m9ofn
-rw-r-----. 1 oracle oinstall     5251072 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_2e2m9og8
-rw-r-----. 1 oracle oinstall   246423552 Mar 22 15:31 data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_2b2m9ofn
-rw-r-----. 1 oracle oinstall     5251072 Mar 22 15:32 data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_2f2m9og8
-rw-r-----. 1 oracle oinstall    76546048 Mar 22 15:37 362mbft5_102_1_1
-rw-r-----. 1 oracle oinstall    14671872 Mar 22 15:37 392mbg1i_105_1_1
-rw-r-----. 1 oracle oinstall    79462400 Mar 22 15:37 372mbftb_103_1_1
-rw-r-----. 1 oracle oinstall      917504 Mar 22 15:37 3a2mbg23_106_1_1
-rw-r-----. 1 oracle oinstall   428498944 Mar 22 15:37 352mbfst_101_1_1
-rw-r-----. 1 oracle oinstall    88702976 Mar 22 15:37 382mbftm_104_1_1
-rw-r-----. 1 oracle oinstall     5021696 Mar 22 15:37 3b2mbg2b_107_1_1
-rw-r-----. 1 oracle oinstall      278528 Mar 22 15:38 3c2mbg2f_108_1_1
-rw-r-----. 1 oracle oinstall      278528 Mar 22 15:38 3d2mbg2i_109_1_1
-rw-r-----. 1 oracle oinstall      425984 Mar 22 15:38 3f2mbg2m_111_1_1
-rw-r-----. 1 oracle oinstall      442368 Mar 22 15:38 3g2mbg2q_112_1_1
-rw-r-----. 1 oracle oinstall      278528 Mar 22 15:38 3j2mbg37_115_1_1
-rw-r-----. 1 oracle oinstall      270336 Mar 22 15:38 3k2mbg3a_116_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 15:38 3l2mbg3f_117_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 15:38 3n2mbg3k_119_1_1
-rw-r-----. 1 oracle oinstall       57344 Mar 22 15:38 3m2mbg3g_118_1_1
-rw-r-----. 1 oracle oinstall    11600384 Mar 22 15:52 bct_ntap1.ctf
[oracle@ora-02 ~]$

....

. Verify the available Oracle archived logs on the ANF NFS mount for recovery and note the last log file log sequency number. In this case, it is 10. Our recovery point is up to log sequency number 11.
+
....
[oracle@ora-02 ~]$ ls -ltr /nfsanf/archlog/NTAP1/archivelog/2024_03_22
total 1429548
-r--r-----. 1 oracle oinstall 176650752 Mar 22 12:00 o1_mf_1_2__9m198x6t_.arc
-r--r-----. 1 oracle oinstall  17674752 Mar 22 14:34 o1_mf_1_3__9vn701r5_.arc
-r--r-----. 1 oracle oinstall 188782080 Mar 22 15:20 o1_mf_1_4__9y6gn5co_.arc
-r--r-----. 1 oracle oinstall 183638016 Mar 22 15:21 o1_mf_1_5__9y7p68s6_.arc
-r--r-----. 1 oracle oinstall 193106944 Mar 22 15:21 o1_mf_1_6__9y8ygtss_.arc
-r--r-----. 1 oracle oinstall 179439104 Mar 22 15:22 o1_mf_1_7__9ybjdp55_.arc
-r--r-----. 1 oracle oinstall 198815232 Mar 22 15:23 o1_mf_1_8__9yctxjgy_.arc
-r--r-----. 1 oracle oinstall 185494528 Mar 22 15:24 o1_mf_1_9__9yfrj0b1_.arc
-r--r-----. 1 oracle oinstall 134470144 Mar 22 15:29 o1_mf_1_10__9yomybbc_.arc
[oracle@ora-02 ~]$

....

. As oracle user, set ORACLE_HOME variable to current Oracle installation on standby DB server ora-02, ORACLE_SID to primary Oracle instance SID. In this case, it is NTAP1.
+
....

[oracle@ora-02 ~]$ export ORACLE_HOME=/u01/app/oracle/product/19.0.0/NTAP2
[oracle@ora-02 ~]$ export ORACLE_SID=NTAP1
[oracle@ora-02 ~]$ export PATH=$PATH:$ORACLE_HOME/bin

....


. As oracle user, create a generic Oracle init file in $ORACLE_HOME/dbs directory with proper admin directories configured. Most importantly, have Oracle `flash recovery area` point to ANF NFS mount path as defined in primary Oracle VLDB server.  `flash recovery area` configuration is demonstrated in section `Setup Oracle RMAN incremental merge to image copy on ANF`. Set the Oracle control file to ANF NFS file system.
+
[source, cli]
vi $ORACLE_HOME/dbs/initNTAP1.ora
+
With following example entries:
+
....

*.audit_file_dest='/u01/app/oracle/admin/NTAP1/adump'
*.audit_trail='db'
*.compatible='19.0.0'
*.control_files=('/nfsanf/oracopy/NTAP1.ctl')
*.db_block_size=8192
*.db_create_file_dest='/nfsanf/oracopy/'
*.db_domain='solutions.netapp.com'
*.db_name='NTAP1'
*.db_recovery_file_dest_size=85899345920
*.db_recovery_file_dest='/nfsanf/archlog/'
*.diagnostic_dest='/u01/app/oracle'
*.dispatchers='(PROTOCOL=TCP) (SERVICE=NTAP1XDB)'
*.enable_pluggable_database=true
*.local_listener='LISTENER'
*.nls_language='AMERICAN'
*.nls_territory='AMERICA'
*.open_cursors=300
*.pga_aggregate_target=1024m
*.processes=320
*.remote_login_passwordfile='EXCLUSIVE'
*.sga_target=10240m
*.undo_tablespace='UNDOTBS1'

....
+
The above init file should be replaced by restored backup init file from primary Oracle VLDB server in the case of discrepancy. 

. As oracle user, launch RMAN to run Oracle recovery on the standby DB server host. First, start the Oracle instance in `nomount` state.
+
....

[oracle@ora-02 ~]$ rman target / nocatalog

Recovery Manager: Release 19.0.0.0.0 - Production on Fri Mar 22 16:02:55 2024
Version 19.18.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database (not started)

RMAN> startup nomount;

Oracle instance started

Total System Global Area   10737418000 bytes

Fixed Size                     9174800 bytes
Variable Size               1577058304 bytes
Database Buffers            9126805504 bytes
Redo Buffers                  24379392 bytes

....

. Set database ID. The database ID can be retrieved from Oracle file name of image copy on ANF NFS mount point.  
+
....

RMAN> set dbid = 2441823937;

executing command: SET DBID

....

. Restore controlfile from autobackup. If Oracle controlfile and spfile autobackup is enabled, they are backed up in every incremental backup and merge cycle. The latest backup will be restored if multiple copies are available.
+
....

RMAN> restore controlfile from autobackup;

Starting restore at 22-MAR-24
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=2 device type=DISK

recovery area destination: /nfsanf/archlog/
database name (or database unique name) used for search: NTAP1
channel ORA_DISK_1: AUTOBACKUP /nfsanf/archlog/NTAP1/autobackup/2024_03_22/o1_mf_s_1164296325__9z77zyxb_.bkp found in the recovery area
channel ORA_DISK_1: looking for AUTOBACKUP on day: 20240322
channel ORA_DISK_1: restoring control file from AUTOBACKUP /nfsanf/archlog/NTAP1/autobackup/2024_03_22/o1_mf_s_1164296325__9z77zyxb_.bkp
channel ORA_DISK_1: control file restore from AUTOBACKUP complete
output file name=/nfsanf/oracopy/NTAP1.ctl
Finished restore at 22-MAR-24

....

. Restore init file from spfile to a /tmp folder for updating parameter file later to match with primary VLDB.
+
....

RMAN> restore spfile to pfile '/tmp/archive/initNTAP1.ora' from autobackup;

Starting restore at 22-MAR-24
using channel ORA_DISK_1

recovery area destination: /nfsanf/archlog/
database name (or database unique name) used for search: NTAP1
channel ORA_DISK_1: AUTOBACKUP /nfsanf/archlog/NTAP1/autobackup/2024_03_22/o1_mf_s_1164296325__9z77zyxb_.bkp found in the recovery area
channel ORA_DISK_1: looking for AUTOBACKUP on day: 20240322
channel ORA_DISK_1: restoring spfile from AUTOBACKUP /nfsanf/archlog/NTAP1/autobackup/2024_03_22/o1_mf_s_1164296325__9z77zyxb_.bkp
channel ORA_DISK_1: SPFILE restore from AUTOBACKUP complete
Finished restore at 22-MAR-24

....

. Mount control file and validate the database backup image copy.
+
....

RMAN> alter database mount;

released channel: ORA_DISK_1
Statement processed

RMAN> list copy of database tag 'ORACOPYBKUPONANF_LEVEL_0';

List of Datafile Copies
=======================

Key     File S Completion Time Ckp SCN    Ckp Time        Sparse
------- ---- - --------------- ---------- --------------- ------
82      1    A 22-MAR-24       4598427    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_1t2m9nij
        Tag: ORACOPYBKUPONANF_LEVEL_0

83      3    A 22-MAR-24       4598423    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_1u2m9nog
        Tag: ORACOPYBKUPONANF_LEVEL_0

84      4    A 22-MAR-24       4598431    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_1v2m9nu6
        Tag: ORACOPYBKUPONANF_LEVEL_0

58      5    A 21-MAR-24       2379694    18-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_282m9oem
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

52      6    A 21-MAR-24       2379694    18-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_242m9oan
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

90      7    A 22-MAR-24       4598462    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_2c2m9ofn
        Tag: ORACOPYBKUPONANF_LEVEL_0

59      8    A 21-MAR-24       2379694    18-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_292m9oem
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 2, PDB Name: PDB$SEED

71      9    A 22-MAR-24       4598313    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_252m9oc5
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

68      10   A 22-MAR-24       4598308    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_212m9o52
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

66      11   A 22-MAR-24       4598304    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_202m9o22
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

74      12   A 22-MAR-24       4598318    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_2d2m9ofs
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

86      13   A 22-MAR-24       4598445    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_262m9oca
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 4, PDB Name: NTAP1_PDB2

85      14   A 22-MAR-24       4598437    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_222m9o53
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 4, PDB Name: NTAP1_PDB2

87      15   A 22-MAR-24       4598454    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_2a2m9of6
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 4, PDB Name: NTAP1_PDB2

89      16   A 22-MAR-24       4598466    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_2e2m9og8
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 4, PDB Name: NTAP1_PDB2

91      17   A 22-MAR-24       4598450    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_272m9oel
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 5, PDB Name: NTAP1_PDB3

88      18   A 22-MAR-24       4598441    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_232m9oa8
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 5, PDB Name: NTAP1_PDB3

92      19   A 22-MAR-24       4598458    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_2b2m9ofn
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 5, PDB Name: NTAP1_PDB3

93      20   A 22-MAR-24       4598470    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_2f2m9og8
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 5, PDB Name: NTAP1_PDB3

81      21   A 22-MAR-24       4598318    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_1h2m9cap
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

72      22   A 22-MAR-24       4598304    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_1i2m9cap
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

73      23   A 22-MAR-24       4598308    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_1j2m9cap
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

80      24   A 22-MAR-24       4598313    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_1k2m9cap
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

79      25   A 22-MAR-24       4598318    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_1l2m9g3u
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

69      26   A 22-MAR-24       4598304    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_1m2m9g9j
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

70      27   A 22-MAR-24       4598308    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_1n2m9gcg
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

75      28   A 22-MAR-24       4598313    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_1o2m9gd4
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

77      29   A 22-MAR-24       4598318    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_1p2m9ju6
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

67      30   A 22-MAR-24       4598304    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_1q2m9k7a
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

76      31   A 22-MAR-24       4598308    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_1r2m9kfk
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1

78      32   A 22-MAR-24       4598313    22-MAR-24       NO
        Name: /nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_1s2m9kgg
        Tag: ORACOPYBKUPONANF_LEVEL_0
        Container ID: 3, PDB Name: NTAP1_PDB1


....

. Switch database to copy to run recovery without database restore.
+
....

RMAN> switch database to copy;

Starting implicit crosscheck backup at 22-MAR-24
allocated channel: ORA_DISK_1
channel ORA_DISK_1: SID=12 device type=DISK
Crosschecked 33 objects
Finished implicit crosscheck backup at 22-MAR-24

Starting implicit crosscheck copy at 22-MAR-24
using channel ORA_DISK_1
Crosschecked 31 objects
Finished implicit crosscheck copy at 22-MAR-24

searching for all files in the recovery area
cataloging files...
cataloging done

List of Cataloged Files
=======================
File Name: /nfsanf/archlog/NTAP1/autobackup/2024_03_20/o1_mf_s_1164140565__5g56ypks_.bkp
File Name: /nfsanf/archlog/NTAP1/autobackup/2024_03_22/o1_mf_s_1164296325__9z77zyxb_.bkp

datafile 1 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_1t2m9nij"
datafile 3 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_1u2m9nog"
datafile 4 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_1v2m9nu6"
datafile 5 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_282m9oem"
datafile 6 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_242m9oan"
datafile 7 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_2c2m9ofn"
datafile 8 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_292m9oem"
datafile 9 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_252m9oc5"
datafile 10 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_212m9o52"
datafile 11 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_202m9o22"
datafile 12 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_2d2m9ofs"
datafile 13 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_262m9oca"
datafile 14 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_222m9o53"
datafile 15 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_2a2m9of6"
datafile 16 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_2e2m9og8"
datafile 17 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_272m9oel"
datafile 18 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_232m9oa8"
datafile 19 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_2b2m9ofn"
datafile 20 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_2f2m9og8"
datafile 21 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_1h2m9cap"
datafile 22 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_1i2m9cap"
datafile 23 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_1j2m9cap"
datafile 24 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_1k2m9cap"
datafile 25 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_1l2m9g3u"
datafile 26 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_1m2m9g9j"
datafile 27 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_1n2m9gcg"
datafile 28 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_1o2m9gd4"
datafile 29 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_1p2m9ju6"
datafile 30 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_1q2m9k7a"
datafile 31 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_1r2m9kfk"
datafile 32 switched to datafile copy "/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_1s2m9kgg"

....

. Run Oracle recovery up to last available archive log in flash recovery area.
+
....

RMAN> run {
2> set until sequence=11;
3> recover database;
4> }

executing command: SET until clause

Starting recover at 22-MAR-24
using channel ORA_DISK_1

starting media recovery

archived log for thread 1 with sequence 4 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_4__9y6gn5co_.arc
archived log for thread 1 with sequence 5 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_5__9y7p68s6_.arc
archived log for thread 1 with sequence 6 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_6__9y8ygtss_.arc
archived log for thread 1 with sequence 7 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_7__9ybjdp55_.arc
archived log for thread 1 with sequence 8 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_8__9yctxjgy_.arc
archived log for thread 1 with sequence 9 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_9__9yfrj0b1_.arc
archived log for thread 1 with sequence 10 is already on disk as file /nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_10__9yomybbc_.arc
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_4__9y6gn5co_.arc thread=1 sequence=4
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_5__9y7p68s6_.arc thread=1 sequence=5
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_6__9y8ygtss_.arc thread=1 sequence=6
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_7__9ybjdp55_.arc thread=1 sequence=7
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_8__9yctxjgy_.arc thread=1 sequence=8
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_9__9yfrj0b1_.arc thread=1 sequence=9
archived log file name=/nfsanf/archlog/NTAP1/archivelog/2024_03_22/o1_mf_1_10__9yomybbc_.arc thread=1 sequence=10
media recovery complete, elapsed time: 00:01:17
Finished recover at 22-MAR-24

RMAN> exit


Recovery Manager complete.

....
+
[NOTE]

For faster recovery, enable parallel sessions with recovery_parallelism parameter or specify degree of parallel in recovery command for database recovery: `RECOVER DATABASE PARALLEL (DEGREE d INSTANCES DEFAULT);`. In general, degrees of parallelism should be equal to number of CPU cores on the host.

. Exit RMAN, login to Oracle as oracle user via sqlplus to open database and reset log after an incomplete recovery.
+
....

SQL> select name, open_mode from v$database;

NAME      OPEN_MODE
--------- --------------------
NTAP1     MOUNTED

SQL> select instance_name, host_name from v$instance;

INSTANCE_NAME
----------------
HOST_NAME
----------------------------------------------------------------
NTAP1
ora-02


SQL>


SQL> select member from v$logfile;

MEMBER
--------------------------------------------------------------------------------
/u03/orareco/NTAP1/onlinelog/redo03.log
/u03/orareco/NTAP1/onlinelog/redo02.log
/u03/orareco/NTAP1/onlinelog/redo01.log

SQL> alter database rename file '/u03/orareco/NTAP1/onlinelog/redo01.log' to '/nfsanf/oracopy/redo01.log';

Database altered.

SQL> alter database rename file '/u03/orareco/NTAP1/onlinelog/redo02.log' to '/nfsanf/oracopy/redo02.log';

Database altered.

SQL> alter database rename file '/u03/orareco/NTAP1/onlinelog/redo03.log' to '/nfsanf/oracopy/redo03.log';

Database altered.

SQL> alter database open resetlogs;

Database altered.

SQL> show pdbs

    CON_ID CON_NAME                       OPEN MODE  RESTRICTED
---------- ------------------------------ ---------- ----------
         2 PDB$SEED                       READ ONLY  NO
         3 NTAP1_PDB1                     READ WRITE NO
         4 NTAP1_PDB2                     READ WRITE NO
         5 NTAP1_PDB3                     READ WRITE NO

....

. Validate the database structure restored to new host as well as the test row we have inserted before primary VLDB failure. 
+
....

SQL> select name from v$datafile;

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-1_1t2m9nij
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-3_1u2m9nog
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-4_1v2m9nu6
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-5_282m9oem
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-6_242m9oan
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-7_2c2m9ofn
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-8_292m9oem
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-9_252m9oc5
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-10_212m9o52
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-11_202m9o22
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-12_2d2m9ofs

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-13_262m9oca
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-14_222m9o53
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-15_2a2m9of6
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-16_2e2m9og8
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSTEM_FNO-17_272m9oel
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SYSAUX_FNO-18_232m9oa8
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-UNDOTBS1_FNO-19_2b2m9ofn
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-USERS_FNO-20_2f2m9og8
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-21_1h2m9cap
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-22_1i2m9cap
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-23_1j2m9cap

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-24_1k2m9cap
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-25_1l2m9g3u
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-26_1m2m9g9j
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-27_1n2m9gcg
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-28_1o2m9gd4
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-29_1p2m9ju6
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-30_1q2m9k7a
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-31_1r2m9kfk
/nfsanf/oracopy/data_D-NTAP1_I-2441823937_TS-SOE_FNO-32_1s2m9kgg

31 rows selected.

SQL> select member from v$logfile;

MEMBER
--------------------------------------------------------------------------------
/nfsanf/oracopy/redo03.log
/nfsanf/oracopy/redo02.log
/nfsanf/oracopy/redo01.log

SQL> select name from v$controlfile;

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/NTAP1.ctl

SQL> alter session set container=ntap1_pdb1;

Session altered.

SQL> select * from test;

        ID
----------
DT
---------------------------------------------------------------------------
EVENT
--------------------------------------------------------------------------------
         1
21-MAR-24 03.15.03.000000 PM
test oracle incremental merge switch to copy

         2
22-MAR-24 02.22.06.000000 PM
test recovery on a new Azure VM host with image copy on ANF


....

. Drop invalid tempfiles and add new tempfiles to temp tablespaces.
+
....

SQL> select name from v$tempfile;

NAME
--------------------------------------------------------------------------------
/u02/oradata/NTAP1/NTAP1_pdb1/temp01.dbf
/u02/oradata/NTAP1/NTAP1_pdb1/temp02.dbf

SQL> alter tablespace temp add tempfile '/nfsanf/oracopy/ntap1_pdb1_temp01.dbf' size 100M;

Tablespace altered.

SQL> select name from v$tempfile;

NAME
--------------------------------------------------------------------------------
/u02/oradata/NTAP1/NTAP1_pdb1/temp01.dbf
/u02/oradata/NTAP1/NTAP1_pdb1/temp02.dbf
/nfsanf/oracopy/ntap1_pdb1_temp01.dbf

SQL> alter database tempfile '/u02/oradata/NTAP1/NTAP1_pdb1/temp01.dbf' offline;

Database altered.

SQL> alter database tempfile '/u02/oradata/NTAP1/NTAP1_pdb1/temp01.dbf' drop;

Database altered.

SQL> alter database tempfile '/u02/oradata/NTAP1/NTAP1_pdb1/temp02.dbf' offline;

Database altered.

SQL> alter database tempfile '/u02/oradata/NTAP1/NTAP1_pdb1/temp02.dbf' drop;

Database altered.

SQL> select name from v$tempfile;

NAME
--------------------------------------------------------------------------------
/nfsanf/oracopy/ntap1_pdb1_temp01.dbf

SQL>

....


. Other post recovery tasks
+
....

- Add ANF NFS mount to fstab so that the NFS file system will be mounted when DB server host rebooted.

        As azureuser, sudo vi /etc/fstab and add following entry:

        172.30.136.68:/ora-01-u02-copy       /nfsanf        nfs     rw,bg,hard,vers=3,proto=tcp,timeo=600,rsize=262144,wsize=262144,nointr  0       0

- Update the Oracle init file from primary databse init file backup that is restored to /tmp/archive and create spfile as needed.

....

This completes the Oracle VLDB database recovery from backup image copy on ANF NFS file system to a standby DB server host.

====


== Where to find additional information

To learn more about the information described in this document, review the following documents and/or websites:

*  RMAN: Merged Incremental Backup Strategies (Doc ID 745798.1)
+
link:https://support.oracle.com/knowledge/Oracle%20Database%20Products/745798_1.html[https://support.oracle.com/knowledge/Oracle%20Database%20Products/745798_1.html^]

*  RMAN Backup and Recovery User's Guide
+
link:https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/getting-started-rman.html[https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/getting-started-rman.html^]


* Azure NetApp Files
+
link:https://azure.microsoft.com/en-us/products/netapp[https://azure.microsoft.com/en-us/products/netapp^]



