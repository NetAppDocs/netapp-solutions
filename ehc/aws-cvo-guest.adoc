---
sidebar: sidebar
permalink: ehc/aws-cvo-guest.html
keywords: NetApp Solutions, amazon, vmc, aws, vmware managed cloud, enterprise, hybrid, cloud, cloud volumes ontap, cvo
summary:
---

= Deploy new Cloud Volumes ONTAP instance in AWS (do it yourself)
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./../media/

[.lead]
Cloud Volumes ONTAP shares and LUNs can be mounted from VMs that are created in the VMware Cloud on AWS SDDC environment. The volumes can also be mounted on native AWS VM Linux Windows clients, and LUNS can be accessed on Linux or Windows clients as block devices when mounted over iSCSI because Cloud Volumes ONTAP supports iSCSI, SMB, and NFS protocols. Cloud Volumes ONTAP volumes can be set up in a few simple steps.

To replicate volumes from an on-premises environment to the cloud for disaster recovery or migration purposes, establish network connectivity to AWS, either using a site-to-site VPN or DirectConnect. Replicating data from on-premises to Cloud Volumes ONTAP is outside the scope of this document. To replicate data between on-premises and Cloud Volumes ONTAP systems, see link:https://docs.netapp.com/us-en/occm/task_replicating_data.html#setting-up-data-replication-between-systems[Setting up data replication between systems].

NOTE: Use the link:https://cloud.netapp.com/cvo-sizer[Cloud Volumes ONTAP sizer] to accurately size the Cloud Volumes ONTAP instances. Also, monitor on-premises performance to use as inputs in the Cloud Volumes ONTAP sizer.

. Log into NetApp Cloud Central; the Fabric View screen is displayed. Locate the Cloud Volumes ONTAP tab and select Go to Cloud Manager. After you are logged in, the Canvas screen is displayed.
+
image:aws-cvo-guest-1.png[]

. On the Cloud Manager home page, click Add a Working Environment and then select AWS as the cloud and the type of the system configuration.
+
image:aws-cvo-guest-2.png[]

. Provide the details of the environment to be created including the environment name and admin credentials. Click Continue.
+
image:aws-cvo-guest-3.png[]

. Select the add-on services for Cloud Volumes ONTAP deployment, including Cloud Data Sense, Cloud Backup, and Cloud Insights. Click Continue.
+
image:aws-cvo-guest-4.png[]

. On the HA Deployment Models page, choose the Multiple Availability Zones configuration.
+
image:aws-cvo-guest-5.png[]

. On the Region & VPC page, enter the network information and then click Continue.
+
image:aws-cvo-guest-6.png[]

. On the Connectivity and SSH Authentication page, choose connection methods for the HA pair and the mediator.
+
image:aws-cvo-guest-7.png[]

. Specify the floating IP addresses and then click Continue.
+
image:aws-cvo-guest-8.png[]

. Select the appropriate route tables to include routes to the floating IP addresses and then click Continue.
+
image:aws-cvo-guest-9.png[]

. On the Data Encryption page, choose AWS-managed encryption.
+
image:aws-cvo-guest-10.png[]

. Select the license option: Pay-As-You-Go or BYOL for using an existing license. In this example, the Pay-As-You-Go option is used.
+
image:aws-cvo-guest-11.png[]

. Select between several preconfigured packages available based on the type of workload to be deployed on the VMs running on the VMware cloud on AWS SDDC.
+
image:aws-cvo-guest-12.png[]

. On the Review & Approve page, review and confirm the selections.To create the Cloud Volumes ONTAP instance, click Go.
+
image:aws-cvo-guest-13.png[]

. After Cloud Volumes ONTAP is provisioned, it is listed in the working environments on the Canvas page.
+
image:aws-cvo-guest-14.png[]

== Additional configurations for SMB volumes

. After the working environment is ready, make sure the CIFS server is configured with the appropriate DNS and Active Directory configuration parameters. This step is required before you can create the SMB volume.
+
image:aws-cvo-guest-20.png[]

. Select the CVO instance to create the volume and click the Create Volume option. Choose the appropriate size and cloud manager chooses the containing aggregate or use advanced allocation mechanism to place on a specific aggregate. For this demo, SMB is selected as the protocol.
+
image:aws-cvo-guest-21.png[]

. After the volume is provisioned, it is availabe under the Volumes pane. Because a CIFS share is provisioned, you should give your users or groups permission to the files and folders and verify that those users can access the share and create a file.
+
image:aws-cvo-guest-22.png[]

. After the volume is created, use the mount command to connect to the share from the VM running on the VMware Cloud in AWS SDDC hosts.

. Copy the following path and use the Map Network Drive option to mount the volume on the VM running on the VMware Cloud in AWS SDDC.
+
image:aws-cvo-guest-23.png[]
image:aws-cvo-guest-24.png[]

== Connect the LUN to a host

To connect the Cloud Volumes ONTAP LUN to a host, complete the following steps:

. On the Cloud Manager Canvas page, double-click the Cloud Volumes ONTAP working environment to create and manage volumes.

. Click Add Volume > New Volume, select iSCSI, and click Create Initiator Group. Click Continue.
+
image:aws-cvo-guest-30.png[]
image:aws-cvo-guest-31.png[]

. After the volume is provisioned, select the volume, and then click Target IQN. To copy the iSCSI Qualified Name (IQN), click Copy. Set up an iSCSI connection from the host to the LUN.

To accomplish the same for the host residing on the VMware Cloud on AWS SDDC, complete the following steps:

.. RDP to the VM hosted on VMware cloud on AWS.
.. Open the iSCSI Initiator Properties dialog box: Server Manager > Dashboard > Tools > iSCSI Initiator.
.. From the Discovery tab, click Discover Portal or Add Portal and then enter the IP address of the iSCSI target port.
.. From the Targets tab, select the target discovered and then click Log On or Connect.
.. Select Enable Multipath, and then select Automatically Restore This Connection When the Computer Starts or Add This Connection to the List of Favorite Targets. Click Advanced.

NOTE: The Windows host must have an iSCSI connection to each node in the cluster. The native DSM selects the best paths to use.
+
image:aws-cvo-guest-32.png[]

LUNs from the SVM appear as disks to the Windows host. Any new disks that are added are not automatically discovered by the host. Trigger a manual rescan to discover the disks by completing the following steps:

. Open the Windows Computer Management utility: Start > Administrative Tools > Computer Management.
. Expand the Storage node in the navigation tree.
. Click Disk Management.
. Click Action > Rescan Disks.

image:aws-cvo-guest-33.png[]

When a new LUN is first accessed by the Windows host, it has no partition or file system. Initialize the LUN; and optionally, format the LUN with a file system by completing the following steps:

. Start Windows Disk Management.
. Right-click the LUN, and then select the required disk or partition type.
. Follow the instructions in the wizard. In this example, drive F: is mounted.

image:aws-cvo-guest-34.png[]

On the Linux clients, ensure the iSCSI daemon is running. After the LUNs are provisioned, refer to the detailed guidance on iSCSI configuration for your Linux distribution.  For example, Ubuntu iSCSI configuration can be found link:https://ubuntu.com/server/docs/service-iscsi[here]. To verify, run lsblk cmd from the shell.

== Mount Cloud Volumes ONTAP NFS volume on Linux client

To mount the Cloud Volumes ONTAP (DIY) file system from VMs within VMC on AWS SDDC, complete the following steps:

. Connect to the designated Linux instance.

. Open a terminal on the instance using secure shell (SSH) and log in with the appropriate credentials.

. Make a directory for the volume's mount point with the following command.

  $ sudo mkdir /fsxcvotesting01/nfsdemovol01

. Mount the Amazon FSx for NetApp ONTAP NFS volume to the directory that is created in the previous step.

  sudo mount -t nfs nfsvers=4.1,172.16.0.2:/nfsdemovol01 /fsxcvotesting01/nfsdemovol01

image:aws-cvo-guest-40.png[]
image:aws-cvo-guest-41.png[]
