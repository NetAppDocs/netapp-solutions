---
sidebar: sidebar
permalink: ehc/gcp-cvo-guest.html
keywords: NetApp Solutions, google cloud, gcp, gcve, enterprise, hybrid, cloud, cloud volumes ontap, cvo
summary:
---

= Deploy Cloud Volumes ONTAP in Google Cloud (Do It Yourself)
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./../media/

[.lead]
Cloud Volumes ONTAP shares and LUNs can be mounted from VMs that are created in the GCVE private cloud environment. The volumes can also be mounted on the Linux client and on Windows client and LUNS can be accessed on Linux or Windows clients as block devices when mounted over iSCSI because Cloud Volumes ONTAP supports iSCSI, SMB, and NFS protocols. Cloud Volumes ONTAP volumes can be set up in a few simple steps.

To replicate volumes from an on-premises environment to the cloud for disaster recovery or migration purposes, establish network connectivity to Google Cloud, either using a site-to-site VPN or Cloud Interconnect. Replicating data from on-premises to Cloud Volumes ONTAP is outside the scope of this document. To replicate data between on-premises and Cloud Volumes ONTAP systems, see link:mailto:CloudOwner@gve.local#setting-up-data-replication-between-systems[Setting up data replication between systems].

NOTE: Use Cloud volumes sizer to accurately size the Cloud Volumes ONTAP instances. Also monitor on-premises performance to use as inputs in the Cloud Volumes ONTAP sizer.

. Log in to NetApp Cloud Central—the Fabric View screen is displayed. Locate the Cloud Volumes ONTAP tab and select Go to Cloud Manager. After you are logged in, the Canvas screen is displayed.
+
image:gcve-cvo-guest1.png[]

. On the Cloud Manager Canvas tab, click Add a Working Environment and then select Google Cloud Platform as the cloud and the type of the system configuration. Then, click Next.
+
image:gcve-cvo-guest2.png[]

. Provide the details of the environment to be created including the environment name and admin credentials. After you are done, click Continue.
+
image:gcve-cvo-guest3.png[]

. Select or deselect the add-on services for Cloud Volumes ONTAP deployment, including Data Sense & Compliance or Backup to Cloud. Then, click Continue.
+
HINT: A verification pop-up message will be displayed when deactivating add-on services.
Add-on services can be added/removed after CVO deployment, consider to deselect them if not needed from the beginning to avoid costs.
+
image:gcve-cvo-guest4.png[]

. Select a location, choose a firewall policy, and select the checkbox to confirm network connectivity to Google Cloud storage.
+
image:gcve-cvo-guest5.png[]

. Select the license option: Pay-As-You-Go or BYOL for using existing license. In this example, Freemium option is used. Then, click on Continue.
+
image:gcve-cvo-guest6.png[]

. Select between several preconfigured packages available based on the type of workload that will be deployed on the VMs running on VMware cloud on AWS SDDC.
+
HINT: Hoover your mouse over the tiles for details or customize CVO components and ONTAP version by clicking on Change Configuration.
+
image:gcve-cvo-guest7.png[]

. On the Review & Approve page, review and confirm the selections.To create the Cloud Volumes ONTAP instance, click Go.
+
image:gcve-cvo-guest8.png[]

. After Cloud Volumes ONTAP is provisioned, it is listed in the working environments on the Canvas page.
+
image:gcve-cvo-guest9.png[]
+
=== Additional configurations for SMB volumes
+
. After the working environment is ready, make sure the CIFS server is configured with the appropriate DNS and Active Directory configuration parameters. This step is required before you can create the SMB volume.
+
HINT: Click on the Menu Icon (º), select Advanced to display more options and select CIFS setup.
+
image:gcve-cvo-guest10.png[]

. Creating the SMB volume is an easy process. At Canvas, double-click the Cloud Volumes ONTAP working environment to create and manage volumes and click on the Create Volume option. Choose the appropriate size and cloud manager chooses the containing aggregate or use advanced allocation mechanism to place on a specific aggregate. For this demo, CIFS/SMB is selected as the protocol.
+
image:gcve-cvo-guest11.png[]

. After the volume is provisioned, it will be availabe under the Volumes pane. Because a CIFS share is provisioned, give your users or groups permission to the files and folders and verify that those users can access the share and create a file. This step is not required if the volume is replicated from an on-premises environment because the file and folder permissions are all retained as part of SnapMirror replication.
+
HINT: Click on the volume menu (º) to display its options.
+
image:gcve-cvo-guest12.png[]

. After the volume is created, use the mount command to display the volume connection instructions,  then connect to the share from the VMs on Google Cloud VMware Engine.
+
image:gcve-cvo-guest13.png[]

. Copy the following path and use the Map Network Drive option to mount the volume on the VM running on the Google Cloud VMware Engine.
+
image:gcve-cvo-guest14.png[]
+
Once mapped, it can be easily accessed, and the NTFS permissions can be set accordingly.
+
image:gcve-cvo-guest15.png[]

== Connect the LUN on Cloud Volumes ONTAP to a host

To connect the cloud volumes ONTAP LUN to a host, complete the following steps:

. On the Canvas page, double-click the Cloud Volumes ONTAP working environment to create and manage volumes.
. Click Add Volume > New Volume and select iSCSI and click Create Initiator Group. Click Continue.
+
image:gcve-cvo-guest16.png[]
image:gcve-cvo-guest17.png[]

. After the volume is provisioned, select the volume menu (º), and then click Target iQN. To copy the iSCSI Qualified Name (iQN), click Copy. Set up an iSCSI connection from the host to the LUN.

To accomplish the same for the host residing on Google Cloud VMware Engine:

.. RDP to the VM hosted on Google Cloud VMware Engine.
.. Open the iSCSI Initiator Properties dialog box: Server Manager > Dashboard > Tools > iSCSI Initiator.
.. From the Discovery tab, click Discover Portal or Add Portal and then enter the IP address of the iSCSI target port.
.. From the Targets tab, select the target discovered and then click Log on or Connect.
.. Select Enable multipath, and then select Automatically Restore This Connection When the Computer Starts or Add This Connection to the List of Favorite Targets. Click Advanced.
+
NOTE: The Windows host must have an iSCSI connection to each node in the cluster. The native DSM selects the best paths to use.
+
image:gcve-cvo-guest18.png[]
+
LUNs on storage virtual machine (SVM) appear as disks to the Windows host. Any new disks that are added are not automatically discovered by the host. Trigger a manual rescan to discover the disks by completing the following steps:

. Open the Windows Computer Management utility: Start > Administrative Tools > Computer Management.
. Expand the Storage node in the navigation tree.
. Click Disk Management.
. Click Action > Rescan Disks.
+
image:gcve-cvo-guest19.png[]
+
When a new LUN is first accessed by the Windows host, it has no partition or file system. Initialize the LUN; and optionally, format the LUN with a file system by completing the following steps:

. Start Windows Disk Management.
. Right-click the LUN, and then select the required disk or partition type.
. Follow the instructions in the wizard. In this example, drive F: is mounted.

image:gcve-cvo-guest20.png[]

On the Linux clients, ensure the iSCSI daemon is running. Once the LUNs are provisioned, refer to the detailed guidance on iSCSI configuration with Ubuntu as an example here. To verify, run lsblk cmd from the shell.

image:gcve-cvo-guest21.png[]
image:gcve-cvo-guest22.png[]

== Mount Cloud Volumes ONTAP NFS volume on Linux client

To mount the Cloud Volumes ONTAP (DIY) file system from VMs within Google Cloud VMware Engine, follow the below steps:

Provision the volume following the below steps

. In the Volumes tab, click Create New Volume.
. On the Create New Volume page, select a volume type:
+
image:gcve-cvo-guest23.png[]

. In the Volumes tab, place your mouse cursor over the volume, select the menu icon (º), and then click Mount Command.
+
image:gcve-cvo-guest24.png[]

. Click Copy.
. Connect to the designated Linux instance.
. Open a terminal on the instance using secure shell (SSH) and log in with the appropriate credentials.
. Make a directory for the volume's mount point with the following command.
+
  $ sudo mkdir /cvogcvetst
+
image:gcve-cvo-guest25.png[]

. Mount the Cloud Volumes ONTAP NFS volume to the directory that is created in the previous step.
+
  sudo mount 10.0.6.251:/cvogcvenfsvol01 /cvogcvetst
+
image:gcve-cvo-guest26.png[]
image:gcve-cvo-guest27.png[]
