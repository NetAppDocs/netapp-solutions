---
sidebar: sidebar
permalink: virtualization/vmware_vcf_aff_principal_nfs.html
keywords: netapp, vmware, cloud, foundation, vcf, asff, all-flash, nfs, vvol, vvols, array, ontap tools, otv
summary:
---

:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./../media/

[.lead]
Author: Ravi BCB, Josh Powell

== NFS as principal storage for VI Workload Domains

=== Scenario Overview
In this scenario we will demonstrate how to configure NFS datastores as principal storage during the deployment of a VI Workload Domain in VCF. Where appropriate we will refer to external documentation for many of the detailed steps that must be performed in VMware Cloud Manager, and only cover those steps that are specific to the storage configuration portion.

This scenario covers the following high level steps:

* Verify networking for the ONTAP storage virtual machine (SVM) and create a logical interface (lif), if necessary, to carry the NFS traffic.
* Create an export policy to allow the ESXi hosts access to the NFS volume.
* Create an NFS volume on the ONTAP storage system.
* During VI Workload Domain deployment configuration, specify the information to connect to the NFS volume.
* Monitor the storage validation and workload domain deployment.
* Verify that the NFS datastore was created. 

=== Prerequisites
This scenario requires the following components and configurations:

* VCF installation and access to the Cloud Manager interface.
* 4 x ESXi hosts commissioned within Cloud Manager and ready for Workload Domain deployment.
* IP addresses reserved for NFS storage traffic on the VLAN or network segment established for this purpose.

For information on configuring ONTAP storage system refer to the link:https://docs.netapp.com/us-en/ontap/ [ONTAP 9 Documentation] center.

For information on configuring VCF refer to link:https://docs.vmware.com/en/VMware-Cloud-Foundation/index.html[VMware Cloud Foundation Documentation].

=== Deployment Steps
To deploy a VI Workload Domain with an NFS datastore as principal storage, complete the following steps:

.Verify Networking for SVM
[%collapsible]
==== 
Begin by logging into the BlueXP web console and navigating to the Canvas.

. Drag and drop the source (primary) ONTAP storage system onto the destination (secondary) ONTAP storage system.
+
image::bxp-scv-hybrid-41.png[Drag and drop storage systems]

. From the menu that appears select *Replication*.
+
image::bxp-scv-hybrid-42.png[Select replication]

. On the *Destination Peering Setup* page select the destination Intercluster LIFs to be used for the connection between storage systems.
+
image::bxp-scv-hybrid-43.png[Choose Intercluster LIFs]
====

.Create Network Pool in Cloud Manager
[%collapsible]
==== 
Begin by logging into the BlueXP web console and navigating to the Canvas.

. Drag and drop the source (primary) ONTAP storage system onto the destination (secondary) ONTAP storage system.
+
image::bxp-scv-hybrid-41.png[Drag and drop storage systems]

. From the menu that appears select *Replication*.
+
image::bxp-scv-hybrid-42.png[Select replication]

. On the *Destination Peering Setup* page select the destination Intercluster LIFs to be used for the connection between storage systems.
+
image::bxp-scv-hybrid-43.png[Choose Intercluster LIFs]
====